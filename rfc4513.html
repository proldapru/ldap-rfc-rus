<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="Ресурсы проекта Pro-LDAP.ru. RFC по службам каталогов и LDAP." />
<meta name="keywords" content="Pro-LDAP.ru,LDAP,OpenLDAP,slapd,по-русски,на русском,перевод,документация,RFC" />
<link rel="stylesheet" href="/pro-ldap.css" type="text/css">
<title>RFC 4513</title>
<script src="/pro-ldap.js"></script>
</head>
<div style="font-size:90%;font-style:italic;margin:30px">Перевод выполнен участниками проекта <a href="http://pro-ldap.ru">Pro-LDAP.ru</a>. Предложения по улучшению перевода и сообщения об ошибках принимаются на <a href="http://pro-ldap.ru/forum/index.php?topic=40.0">форуме проекта</a>.</div>

<pre>Network Working Group
<strong>Request for Comments: 4513</strong>
Категория: Standards Track
Под редакцией R. Harrison, Novell, Inc.
Июнь 2006 года
Отменяет: <a href="http://tools.ietf.org/html/rfc2251">RFC 2251</a>, <a href="http://tools.ietf.org/html/rfc2829">RFC 2829</a>, <a href="http://tools.ietf.org/html/rfc2830">RFC 2830</a>
</pre>

<h1>Lightweight Directory Access Protocol (LDAP): Методы аутентификации и механизмы обеспечения безопасности</h1>

<h3>Статус документа</h3>

<p>Этот документ определяет проект стандарта протокола Интернет для сообщества Интернет, а также приглашает к обсуждению и подаче предложений по его усовершенствованию. Пожалуйста, сверяйтесь с текущей редакцией "Официальных стандартов протоколов Интернет" (STD 1), чтобы узнать состояние стандартизации и статус этого протокола. Ограничений на распространение данного документа не накладывается.</p>

<h3>Уведомление об авторских правах</h3>

<p>Copyright (C) Internet Society (2006).</p>

<h3>Тезисы</h3>

<p>В этом документе описываются методы аутентификации и механизмы обеспечения безопасности для протокола Lightweight Directory Access Protocol (LDAP). Здесь же детализируется установление соединения Transport Layer Security (TLS) с использованием операции StartTLS.</p>

<p>В этом документе даётся подробное описание метода аутентификации простого подсоединения (Simple Bind), в том числе механизмы анонимного подсоединения, неаутентифицированного подсоединения и подсоединения с предоставлением имени пользователя и пароля, а также метода аутентификации подсоединения с использованием Simple Authentication and Security Layer (SASL), в том числе механизм EXTERNAL.</p>

<p>В этом документе обсуждаются различные состояния аутентификации и авторизации, через которые может пройти сеанс работы с LDAP-сервером, а также действия, которые вызывают изменение этих состояний.</p>

<p>Этот документ, совместно с другими документами технической спецификации LDAP (смотрите <a href="#section-1">раздел 1</a> и <a href="http://tools.ietf.org/html/rfc4510">путеводитель по технической спецификации</a>), отменяет <a href="http://tools.ietf.org/html/rfc2251">RFC 2251</a>, <a href="http://tools.ietf.org/html/rfc2829">RFC 2829</a> и <a href="http://tools.ietf.org/html/rfc2830">RFC 2830</a>.</p>

<h3>Содержание</h3>
<div class="contents">
<ul>
<li>1. <a href="#section-1">Введение</a>
    <ul>
      <li>1.1. <a href="#section-1.1">Взаимосвязь с другими документами</a></li>
      <li>1.2. <a href="#section-1.2">Соглашения</a></li>
    </ul>
</li>
<li>2. <a href="#section-2">Требования к реализациям</a></li>
<li>3. <a href="#section-3">Операция StartTLS</a>
    <ul>
      <li>3.1. <a href="#section-3.1">Процедуры установления TLS</a>
        <ul>
          <li>3.1.1. <a href="#section-3.1.1">Последовательность выполнения операций при запросе StartTLS</a></li>
          <li>3.1.2. <a href="#section-3.1.2">Сертификат клиента</a></li>
          <li>3.1.3. <a href="#section-3.1.3">Проверка идентификационной сущности сервера</a>
            <ul>
              <li>3.1.3.1. <a href="#section-3.1.3.1">Сравнение имён DNS</a></li>
              <li>3.1.3.2. <a href="#section-3.1.3.2">Сравнение IP-адресов</a></li>
              <li>3.1.3.3. <a href="#section-3.1.3.3">Сравнение других типов subjectName</a></li>
            </ul>
          </li>
          <li>3.1.4. <a href="#section-3.1.4">Оценка полученного в результате уровня обеспечения безопасности</a></li>
          <li>3.1.5. <a href="#section-3.1.5">Обновление информации о возможностях сервера</a></li>
        </ul>
      </li>
      <li>3.2. <a href="#section-3.2">Влияние TLS на состояние авторизации</a></li>
      <li>3.3. <a href="#section-3.3">Наборы шифров TLS</a></li>
    </ul>
</li>
<li>4. <a href="#section-4">Состояние авторизации</a></li>
<li>5. <a href="#section-5">Операция подсоединения Bind</a>
    <ul>
      <li>5.1. <a href="#section-5.1">Метод простой аутентификации</a>
        <ul>
          <li>5.1.1. <a href="#section-5.1.1">Простое подсоединение: механизм анонимной аутентификации</a></li>
          <li>5.1.2. <a href="#section-5.1.2">Простое подсоединение: механизм аутентификации без проверки подлинности</a></li>
          <li>5.1.3. <a href="#section-5.1.3">Простое подсоединение: механизм аутентификации по имени пользователя и паролю</a></li>
        </ul>
      </li>
      <li>5.2. <a href="#section-5.2">Метод аутентификации SASL</a>
        <ul>
          <li><a href="#section-5.2.1">5.2.1. SASL-профиль протокола</a>
            <ul>
              <li>5.2.1.1. <a href="#section-5.2.1.1">Имя сервиса SASL для LDAP</a></li>
              <li>5.2.1.2. <a href="#section-5.2.1.2">Инициация аутентификации и обмен сообщениями протокола SASL</a></li>
              <li>5.2.1.3. <a href="#section-5.2.1.3">Опциональные поля</a></li>
              <li>5.2.1.4. <a href="#section-5.2.1.4">Октет, с которого вступают в силу уровни безопасности</a></li>
              <li>5.2.1.5. <a href="#section-5.2.1.5">Определение поддерживаемых механизмов SASL</a></li>
              <li>5.2.1.6. <a href="#section-5.2.1.6">Правила использования уровней SASL</a></li>
              <li>5.2.1.7. <a href="#section-5.2.1.7">Поддержка множественной аутентификации</a></li>
              <li>5.2.1.8. <a href="#section-5.2.1.8">Авторизационные идентификационные сущности SASL</a></li>
            </ul>
          </li>
          <li>5.2.2. <a href="#section-5.2.2">Семантики SASL в LDAP</a></li>
          <li>5.2.3. <a href="#section-5.2.3">Механизм аутентификации SASL EXTERNAL</a>
            <ul>
              <li>5.2.3.1. <a href="#section-5.2.3.1">Неявное заявление</a></li>
              <li>5.2.3.2. <a href="#section-5.2.3.2">Явное заявление</a></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
</li>
<li>6. <a href="#section-6">О безопасности</a>
    <ul>
      <li>6.1. <a href="#section-6.1">Общие соображения безопасности, касающиеся LDAP</a></li>
      <li>6.2. <a href="#section-6.2">Соображения безопасности, касающиеся операции StartTLS</a></li>
      <li>6.3. <a href="#section-6.3">Соображения безопасности, касающиеся операции Bind</a>
        <ul>
          <li>6.3.1. <a href="#section-6.3.1">Соображения безопасности, касающиеся механизма аутентификации без проверки подлинности</a></li>
          <li>6.3.2. <a href="#section-6.3.2">Соображения безопасности, касающиеся механизма аутентификации по имени пользователя и паролю</a></li>
          <li>6.3.3. <a href="#section-6.3.3">Соображения безопасности, связанные с паролями</a></li>
          <li>6.3.4. <a href="#section-6.3.4">Соображения безопасности по хэшированным паролям</a></li>
        </ul>
      </li>
      <li>6.4. <a href="#section-6.4">Соображения безопасности, связанные с SASL</a></li>
      <li>6.5. <a href="#section-6.5">Другие соображения безопасности по теме</a></li>
    </ul>
</li>
<li>7. <a href="#section-7">Регистрация в IANA</a></li>
<li>8. <a href="#section-8">Благодарности</a></li>
<li>9. <a href="#section-9">Нормативные документы</a></li>
<li>10. <a href="#section-10">Информативные документы</a></li>
<li>Приложение A. <a href="#appendix-A">Концепции аутентификации и авторизации</a>
    <ul>
      <li>A.1. <a href="#appendix-A.1">Политика контроля доступа</a></li>
      <li>A.2. <a href="#appendix-A.2">Факторы контроля доступа</a></li>
      <li>A.3. <a href="#appendix-A.3">Аутентификация, удостоверяющие данные, идентификационные сущности</a></li>
      <li>A.4. <a href="#appendix-A.4">Авторизационная идентификационная сущность</a></li>
    </ul>
</li>
<li>Приложение B. <a href="#appendix-B">Обзор изменений</a>
    <ul>
      <li>B.1. <a href="#appendix-B.1">Изменения, внесённые в RFC 2251</a>
        <ul>
          <li>B.1.1. <a href="#appendix-B.1.1">Раздел 4.2.1 (Последовательность запросов Bind)</a></li>
          <li>B.1.2. <a href="#appendix-B.1.2">Раздел 4.2.2 (Аутентификация и другие сервисы обеспечения безопасности)</a></li>
        </ul>
      </li>
      <li>B.2. <a href="#appendix-B.2">Изменения, внесённые в RFC 2829</a>
        <ul>
          <li>B.2.1. <a href="#appendix-B.2.1">Раздел 4 (Требуемые механизмы обеспечения безопасности)</a></li>
          <li>B.2.2. <a href="#appendix-B.2.2">Раздел 5.1 (Процедура анонимной аутентификации)</a></li>
          <li>B.2.3. <a href="#appendix-B.2.3">Раздел 6 (Аутентификация на основе пароля)</a></li>
          <li>B.2.4. <a href="#appendix-B.2.4">Раздел 6.1 (Аутентификация Digest)</a></li>
          <li>B.2.5. <a href="#appendix-B.2.5">Раздел 6.2 (Способ аутентификации 'simple' при шифровании TLS)</a></li>
          <li>B.2.6. <a href="#appendix-B.2.6">Раздел 6.3 (Другие способы аутентификации с TLS)</a></li>
          <li>B.2.7. <a href="#appendix-B.2.7">Раздел 7.1 (Аутентификация, основанная на использовании сертификата, с TLS)</a></li>
          <li>B.2.8. <a href="#appendix-B.2.8">Раздел 8 (Другие механизмы)</a></li>
          <li>B.2.9. <a href="#appendix-B.2.9">Раздел 9 (Авторизационная идентификационная сущность)</a></li>
          <li>B.2.10. <a href="#appendix-B.2.10">Раздел 10 (Наборы шифров TLS)</a></li>
        </ul>
      </li>
      <li>B.3. <a href="#appendix-B.3">Изменения, внесённые в RFC 2830</a>
        <ul>
          <li>B.3.1. <a href="#appendix-B.3.1">Раздел 3.6 (Проверка идентификационной сущности сервера)</a></li>
          <li>B.3.2. <a href="#appendix-B.3.2">Раздел 3.7 (Обновление информации о возможностях сервера)</a></li>
          <li>B.3.3. <a href="#appendix-B.3.3">Раздел 5 (Влияние TLS на авторизационную идентификационную сущность клиента)</a></li>
          <li>B.3.4. <a href="#appendix-B.3.4">Раздел 5.2 (Последствия закрытия соединения TLS)</a></li>
        </ul>
      </li>
    </ul>
</li>
</ul>
</div>

<h2><a name="section-1">1</a>. Введение</h2>

<p>Lightweight Directory Access Protocol (LDAP) [<a href="http://tools.ietf.org/html/rfc4510" title="LDAP: Technical Specification Road Map">RFC4510</a>]&thinsp;&mdash;&thinsp;мощный протокол для доступа к каталогам. Он предлагает средства поиска и извлечения информации из каталога, манипулирования содержимым каталога, а также различные способы предоставления доступа к каталогу с богатым набором функций обеспечения безопасности.</p>

<p>Жизненно важно, чтобы эти функции обеспечения безопасности позволяли выполнять взаимодействие между всеми клиентами и серверами LDAP в сети Интернет; поэтому должно быть определено минимальное подмножество функции обеспечения безопасности, которое было бы общим для всех реализаций, утверждающих своё соответствие спецификации LDAP.</p>

<p>Основные угрозы для службы каталогов LDAP (неисчерпывающий список):</p>
<ol>
<li>Неавторизованный доступ к данным каталога посредством операций извлечения данных.</li>
<li>Неавторизованный доступ к данным каталога путём мониторинга доступа других пользователей.</li>
<li>Неавторизованный доступ к информации многократного использования, касающейся аутентификации клиента, путём мониторинга доступа других пользователей.</li>
<li>Неавторизованная модификация данных каталога.</li>
<li>Неавторизованная модификация конфигурационной информации.</li>
<li>Отказ от обслуживания: Использование ресурсов (обычно избыточное) с целью привести к отказу от обслуживания других пользователей.</li>
<li>Подмена (спуфинг): Введение пользователя или клиента в заблуждение, что информация поступила из каталога (хотя на самом деле это не так) либо путём модификации данных в процессе передачи, либо путём перенаправления транспортного соединения клиента. Провоцирование пользователя и клиента на отправку конфиденциальной информации злоумышленнику, который выдаёт себя за каталог, но таковым не является. Введение сервера каталога в заблуждение, что информация поступила от конкретного клиента, хотя на самом деле она поступила от злоумышленника.</li>
<li>Угон (hijacking): Захват злоумышленником контроля над установленным сеансом протокола.</li>
</ol>

<p>Угрозы (1), (4), (5), (6), (7) и (8) представляют собой активные атаки. Угрозы (2) и (3)&thinsp;&mdash;&thinsp;пассивные.</p>

<p>Угрозы (1), (4), (5) и (6) связаны с работой злоумышленников-клиентов. Угрозы (2), (3), (7) и (8) связаны с работой злоумышленников-агентов на пути между клиентом и сервером, либо злоумышленников-агентов, выдающих себя за сервер, например, с помощью IP-спуфинга.</p>

<p>LDAP предлагает следующие механизмы обеспечения безопасности:</p>
<ol>
<li>Аутентификация посредством операции подсоединения Bind. Операция Bind предоставляет простой метод, поддерживающий механизмы анонимного подсоединения, неаутентифицированного подсоединения и подсоединения с предоставлением имени пользователя и пароля, а также метод Simple Authentication and Security Layer (SASL), поддерживающий широкий выбор механизмов аутентификации.</li>
<li>Механизмы для поддержки средств контроля доступа по усмотрению производителя (в LDAP не предусмотрено стандартных средств контроля доступа).</li>
<li>Сервис обеспечения целостности данных посредством уровней безопасности в Transport Layer Security (TLS) или механизмов SASL.</li>
<li>Сервис обеспечения конфиденциальности данных посредством уровней безопасности в TLS или механизмов SASL.</li>
<li>Ограничение использования ресурсов сервера посредством настраиваемых на сервере административных ограничений.</li>
<li>Аутентификация сервера посредством протокола TLS или механизмов SASL.</li>
<li>LDAP также может быть защищён с помощью средств, выходящих за рамки технической спецификации протокола LDAP, например, с помощью уровня безопасности IP [<a href="http://tools.ietf.org/html/rfc4301" title="Security Architecture for the Internet Protocol">RFC4301</a>].</li>
</ol>

<p>Опыт показывает, что если просто позволять внедрять в реализациях протокола механизмы обеспечения безопасности по своему выбору, то такая стратегия не приводит к совместимости приложений. В отсутствии обязательных требований клиенты будут продолжать выдавать сообщения, что они не поддерживают какие-либо функции обеспечения безопасности, поддерживаемые сервером, или, и того хуже, они будут поддерживать только те механизмы, которые обеспечивают недостаточный уровень безопасности в большинстве ситуаций.</p>

<p>Желательно позволить клиентам проводить аутентификацию с использованием различных механизмов, в том числе механизмов, где идентификационные сущности представлены как уникальные имена [<a href="#ref-X.501" title="The Directory: Models">X.501</a>][<a href="rfc4512.html#section-2.3" title="LDAP: Информационные модели каталога">RFC4512</a>], в строковой форме [<a href="http://tools.ietf.org/html/rfc4514" title="LDAP: String Representation of Distinguished Names">RFC4514</a>] или так, как они используются в различных системах (например, простые имена пользователей [<a href="http://tools.ietf.org/html/rfc4013" title="SASLprep: Stringprep Profile for User Names and Passwords">RFC4013</a>]). Поскольку некоторые механизмы аутентификации передают идентификационные данные в форме открытого текста, и/или не предоставляют сервисов обеспечения безопасности данных, и/или являются предметом пассивных атак, необходимо обеспечить совместимость приложений с точки зрения защиты данных путем определения обязательного для реализации механизма установления сервисов безопасности транспортного уровня.</p>

<p>Предоставляемый в LDAP и описываемый в этом документе набор механизмов обеспечения безопасности предназначен для того, чтобы удовлетворить потребности безопасности широкого спектра сценариев развертывания и при этом обеспечить высокую степень совместимости между различными реализациями и системами LDAP.</p>

<h3><a name="section-1.1">1.1</a>. Взаимосвязь с другими документами</h3>

<p>Этот документ является неотъемлемой частью технической спецификации LDAP [<a href="http://tools.ietf.org/html/rfc4510" title="LDAP: Technical Specification Road Map">RFC4510</a>].</p>

<p>Этот документ, совместно с [<a href="http://tools.ietf.org/html/rfc4510" title="LDAP: Technical Specification Road Map">RFC4510</a>], [<a href="rfc4511.html" title="LDAP: Определение протокола">RFC4511</a>] и [<a href="rfc4512.html" title="LDAP: Информационные модели каталога">RFC4512</a>], полностью отменяет <a href="http://tools.ietf.org/html/rfc2251">RFC 2251</a>. Этот документ отменяет разделы <a href="http://tools.ietf.org/html/rfc2251#section-4.2.1">4.2.1</a> (частично) и <a href="http://tools.ietf.org/html/rfc2251#section-4.2.2">4.2.2</a> <a href="http://tools.ietf.org/html/rfc2251">RFC 2251</a>. Основные изменения, внесённые в <a href="http://tools.ietf.org/html/rfc2251">RFC 2251</a> этим документом, обобщены в <a href="#appendix-B.1">приложении B.1</a>.</p>

<p>Этот документ полностью отменяет <a href="http://tools.ietf.org/html/rfc2829">RFC 2829</a>. Основные изменения, внесённые в <a href="http://tools.ietf.org/html/rfc2829">RFC 2829</a> этим документом, обобщены в <a href="#appendix-B.2">приложении B.2</a>.</p>

<p>Разделы <a href="http://tools.ietf.org/html/rfc2830#section-2">2</a> and <a href="http://tools.ietf.org/html/rfc2830#section-4">4</a> <a href="http://tools.ietf.org/html/rfc2830">RFC 2830</a> отменены [<a href="rfc4511.html" title="LDAP: Определение протокола">RFC4511</a>]. Оставшаяся часть <a href="http://tools.ietf.org/html/rfc2830">RFC 2830</a> отменяется этим документом. Основные изменения, внесённые в <a href="http://tools.ietf.org/html/rfc2830">RFC 2830</a> этим документом, обобщены в <a href="#appendix-B.3">приложении B.3</a>.</p>

<h3><a name="section-1.2">1.2</a>. Соглашения</h3>

<p>Ключевые слова "MUST" (необходимо), "MUST NOT" (недопустимо), "SHALL" (нужно), "SHOULD" (следует), "SHOULD NOT" (не следует), "MAY" (возможно) и "OPTIONAL" (необязательно) в данном документе должны интерпретироваться так, как описано в [<a href="http://rfc2.ru/2119.rfc" title="Ключевые слова для обозначения уровня требований в RFC">RFC2119</a>].</p>

<p>Термин "пользователь" ("user") означает любого человека или приложение, получающее доступ к каталогу с помощью клиента каталога. Клиент каталога (или просто клиент) ещё называется пользовательским агентом каталога (Directory user agent, DUA).</p>

<p>Термин "транспортное соединение" ("transport connection") обозначает базовые транспортные сервисы, используемые для проведения обмена сообщениями протокола, а также соединения, установленные этими сервисами.</p>

<p>Термин "уровень TLS" ("TLS layer") обозначает сервисы TLS, используемые для обеспечения безопасности при передаче информации, а также соединения, установленные этими сервисами.</p>

<p>Термин "уровень SASL" ("SASL layer") обозначает сервисы SASL, используемые для обеспечения безопасности при передаче информации, а также соединения, установленные этими сервисами.</p>

<p>Термин "уровень сообщений LDAP" ("LDAP message layer") обозначает сервисы LDAP Message PDU, используемые для предоставления услуг служб каталогов, а также соединения, установленные этими сервисами.</p>

<p>Термин "сессия LDAP" ("LDAP session") обозначает комбинированные сервисы (транспортное соединение, уровень TLS, уровень SASL, уровень сообщений LDAP) и их соединения.</p>

<p>В общем случае, термины безопасности в этом документе используются так, как они определены в [<a href="http://tools.ietf.org/html/rfc2828" title="Internet Security Glossary">RFC2828</a>]. Кроме того, некоторые термины и концепции, относящиеся к защите информации, аутентификации и авторизации, приведены в <a href="#appendix-A">приложении A</a> этого документа. Хотя формальные определения этих терминов и концепций выходят за рамки настоящего документа, понимание их является необходимым условием для понимания большей части материала в этом документе. Читателям, которые не знакомы с концепциями защиты информации, рекомендуется перед тем, как читать этот документ далее, ознакомиться с <a href="#appendix-A">приложением A</a>.</p>

<h2><a name="section-2">2</a>. Требования к реализациям</h2>

<p>Реализации сервера LDAP должны (MUST) поддерживать механизм анонимной аутентификации <a href="#section-5.1">метода простого подсоединения</a> (<a href="#section-5.1.1">раздел 5.1.1</a>).</p>

<p>Реализации LDAP, поддерживающие любые другие механизмы аутентификации, кроме механизма анонимной аутентификации <a href="#section-5.1">метода простого подсоединения</a>, должны (MUST) поддерживать механизм аутентификации по имени пользователя и паролю <a href="#section-5.1">метода простого подсоединения</a> (<a href="#section-5.1.3">раздел 5.1.3</a>) и должны (MUST) быть способными защищать данную аутентификацию по имени пользователя и паролю с помощью TLS, устанавливаемого операцией StartTLS (<a href="#section-3">раздел 3</a>).</p>

<p>Реализациям следует (SHOULD) по умолчанию запрещать использование механизма аутентификации по имени пользователя и паролю, если надлежащий уровень защиты данных не был обеспечен соответствующими сервисами обеспечения безопасности; кроме того, реализации могут (MAY) предоставлять другие подходящие сервисы обеспечения безопасности данных для использования с этим механизмом аутентификации.</p>

<p>Реализации могут (MAY) поддерживать дополнительные механизмы аутентификации. Некоторые из этих механизмов обсуждаются ниже.</p>

<p>Реализациям сервера LDAP следует (SHOULD) поддерживать связывание сессии с авторизационной идентификационной сущностью, заявленной клиентом посредством механизма SASL EXTERNAL (<a href="#section-5.2.3">раздел 5.2.3</a>).</p>

<p>Реализациям сервера LDAP, не поддерживающим никаких механизмов аутентификации, кроме механизма анонимной аутентификации <a href="#section-5.1">метода простого подсоединения</a>, следует (SHOULD) поддерживать использование TLS, устанавливаемого операцией StartTLS (<a href="#section-3">раздел 3</a>). (Другие серверы должны (MUST) поддерживать TLS так, как это описано во втором параграфе этого раздела.)</p>

<p>Реализациям, поддерживающим TLS, необходимо (MUST) поддерживать набор шифров TLS_RSA_WITH_3DES_EDE_CBC_SHA и следует (SHOULD) поддерживать набор шифров TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA. Поддержка последнего набора шифров рекомендуется для обеспечения совместимости с реализациями, работающими согласно более ранним спецификациям операции LDAP StartTLS.</p>

<h2><a name="section-3">3</a>. Операция StartTLS</h2>

<p>Операция Start Transport Layer Security (StartTLS), определённая в <a href="rfc4511.html#section-4.14">разделе 4.14 [RFC4511]</a>, обеспечивает возможность установления TLS [<a href="http://tools.ietf.org/html/rfc4346" title="The TLS Protocol Version 1.1">RFC4346</a>] в сессии LDAP.</p>

<p>Целью использования протокола TLS с LDAP является обеспечение конфиденциальности и целостности данных, а также, опционально, предоставление данных для аутентификации.  Эти возможности явно предусмотрены в TLS, хотя сервисы аутентификации TLS доступны для LDAP только в комбинации с методом аутентификации SASL EXTERNAL (смотрите <a href="#section-5.2.3">раздел 5.2.3</a>), и то лишь в том случае, когда реализация SASL EXTERNAL примет решение использовать удостоверяющие данные TLS.</p>

<h3><a name="section-3.1">3.1</a>. Процедуры установления TLS</h3>

<p>В этом разделе описываются общие процедуры, которым должны следовать клиенты и серверы для установления TLS. В этих процедурах учитываются различные аспекты уровня TLS, в том числе <a href="#section-3.1.4">выявление результативного уровня обеспечения безопасности</a> и <a href="#section-3.2">утверждение авторизационной идентификационной сущности клиента</a></span>.</p>

<h4><a name="section-3.1.1">3.1.1</a>. Последовательность выполнения операций при запросе StartTLS</h4>

<p>Клиент может отправить расширенный запрос StartTLS в любой момент после установления сессии LDAP, за исключением случаев, когда:</p>
<ul>
<li>TLS уже установлен в этой сессии,</li>
<li>в этой сессии ведутся многоступенчатые переговоры SASL, или</li>
<li>не были получены ответы на запросы уже выполняющихся в рамках этой сессии операций.</li>
</ul>
<p>Как сказано в <a href="rfc4511.html#section-4.14.1">разделе 4.14.1 RFC4511</a>, нарушение (выявленное) любого из этих требований приводит к возврату результирующего кода operationsError.</p>

<p>Разработчики клиентов должны обеспечить, чтобы клиент строго придерживался этих требований последовательности выполнения операций для предотвращения проблем взаимодействия с серверами. Опыт работы показывает, что нарушение этих требований вызывает проблемы взаимодействия, поскольку существуют особого рода условия, не позволяющие серверу определить некоторые нарушения этих требований вследствие таких факторов, как недостаточная производительность серверного оборудования и низкая скорость сетевых соединений.</p>

<p>Не существует общего требования, должен или нет клиент выполнить операцию Bind (<a href="#section-5">раздел 5</a>) перед тем, как посылать запрос операции StartTLS; однако, если клиент планирует выполнить обе операции Bind и StartTLS, ему следует (SHOULD) сначала выполнить операцию StartTLS для того, чтобы сообщения запроса и ответа Bind были защищены сервисами обеспечения безопасности данных, установленными операцией StartTLS.</p>

<h4><a name="section-3.1.2">3.1.2</a>. Сертификат клиента</h4>

<p>Если сервер LDAP запрашивает, чтобы клиент в ходе переговоров TLS предоставил сертификат пользователя, а у клиента нет в наличии подходящего сертификата пользователя (например, такого, подлинность которого можно было бы подтвердить), сервер может использовать локальную политику безопасности для определения того, будет ли окончание переговоров TLS считаться успешным.</p>

<p>Если клиент предоставил подходящий сертификат и вслед за этим выполняет операцию Bind с использованием механизма аутентификации SASL EXTERNAL (<a href="#section-5.2.3">раздел 5.2.3</a>), информация из этого сертификата может быть использована сервером для идентификации и аутентификации клиента.</p>

<h4><a name="section-3.1.3">3.1.3</a>. Проверка идентификационной сущности сервера</h4>

<p>Для предотвращения атак типа "человек посередине" (man-in-the-middle), клиент должен (MUST) проверять идентификационную сущность сервера (как она представлена в сообщении сертификата сервера). В данном разделе то, что клиент понимает под идентификационной сущностью сервера (обычно идентификационная сущность, используемая при установке  транспортного соединения), называется "заявляемой идентификационной сущностью" ("reference identity").</p>

<p>Клиент определяет тип заявляемой идентификационной сущности (например, DNS-имя или IP-адрес) и выполняет её сравнение с каждым значением поля subjectAltName соответствующего типа, пока не получит совпадения. Как только совпадение получено, идентификационная сущность сервера считается проверенной, а проверка идентификационной сущности сервера&thinsp;&mdash;&thinsp;выполненной. Различные типы поля subjectAltName сравниваются по-разному. В разделах <a href="#section-3.1.3.1">3.1.3.1</a>-<a href="#section-3.1.3.3">3.1.3.3</a> поясняется, каким образом сравнивать значения различных типов subjectAltName.</p>

<p>Клиент может отобразить заявляемую идентификационную сущность в другой тип до выполнения сравнения. Отображения могут быть выполнены для всех доступных типов subjectAltName, в которые может быть отображена заявляемая идентификационная сущность; однако, она должна отображаться только в типы, для которых такое отображение либо безопасно по своей сути (например, выделение DNS-имени из URI для сравнения с полем subjectAltName типа dNSName), либо выполняется безопасным способом (например, использование DNSSEC или сконфигурированных пользователем или администратором поисковых таблиц соответствия хоста адресу или адреса хосту).</p>

<p>Идентификационная сущность сервера может также быть проверена путём сравнения заявляемой идентификационной сущности с значением Common Name (CN) [<a href="http://tools.ietf.org/html/rfc4519" title="LDAP: Schema for User Applications">RFC4519</a>] листового относительного отличительного имени (RDN) поля subjectName сертификата сервера. Это сравнение выполняется с использованием правил сравнения имён DNS, описанных ниже в <a href="#section-3.1.3.1">разделе 3.1.3.1</a>, за исключением того, что не разрешён поиск совпадений по шаблонам. Хотя использование значений Common Name является устоявшейся практикой, этот подход устарел, и удостоверяющим центрам (Certification Authorities) рекомендовано вместо этого предоставлять значения в поле subjectAltName. Имейте ввиду, что реализации TLS могут представлять уникальные имена (DN) в сертификатах в соответствии со стандартом X.500 или другими соглашениями. Например, некоторые реализации X.500 располагают RDN и DN в порядке слева-направо (от наиболее значимого до наименее значимого) вместо принятого в LDAP порядка справа-налево.</p>

<p>Если проверка идентификационной сущности сервера завершается неудачей, клиентам, ориентированным на пользователя, следует (SHOULD) либо уведомить пользователя (в этом случае клиенты могут предоставить пользователю возможность продолжить работу с этой сессией LDAP), либо закрыть транспортное соединение и указать, что подлинность сервера вызывает подозрения. Клиентам, работающим без непосредственного участия пользователя, следует (SHOULD) закрыть транспортное соединение, после чего вернуть или поместить в журнал (или и то и другое вместе) ошибку, указывающую на то, что подлинность сервера вызывает подозрения.</p>

<p>Помимо описанной в этом разделе проверки идентификационной сущности сервера, клиентам следует быть готовыми произвести дальнейшие проверки чтобы убедиться, что сервер имеет право (авторизован) предоставлять те сервисы, которые у него запрашиваются. При принятии решения о таких проверках клиенту может потребоваться использовать информацию локальной политики безопасности.</p>

<h5><a name="section-3.1.3.1">3.1.3.1</a>. Сравнение имён DNS</h5>

<p>Если заявляемая идентификационная сущность представляет собой интернационализованное доменное имя (IDN), реализации, соответствующие требованиям этого документа, должны (MUST) преобразовать его в формат ASCII Compatible  Encoding (ACE) как определено в <a href="http://tools.ietf.org/html/rfc3490#section-4" title="Internationalizing Domain Names in Applications (IDNA)">разделе 4 RFC 3490</a> перед тем, как выполнять сравнение со значениями поля subjectAltName типа dNSName. Конкретнее, реализации, соответствующие требованиям этого документа, должны (MUST) выполнять определённую в <a href="http://tools.ietf.org/html/rfc3490#section-4">разделе 4 RFC3490</a> операцию преобразования следующим образом:</p>
<ul>
<li>на шаге 1 доменное имя нужно (SHALL) рассматривать как "хранимую строку" ("stored string");</li>
<li>на шаге 3 устанавливается флаг, называемый "UseSTD3ASCIIRules";</li>
<li>на шаге 4 каждая метка обрабатывается операцией "ToASCII"; и</li>
<li>на шаге 5 все разделители меток меняются на U+002E (полная остановка).</li>
</ul>
<p>После выполнения преобразования "to-ASCII", должно (MUST) быть выполнено сравнение меток и имён DNS на эквивалентность согласно правилам, определённым в <a href="http://tools.ietf.org/html/rfc3490#section-3">разделе 3 RFC3490</a>.</p>

<p>Знак шаблона '*' (ASCII 42) разрешён в значениях поля subjectAltName типа dNSName, но только в качестве крайней слева (наименее значимой) метки DNS в таком значении. Этот шаблон совпадает с любой крайней слева меткой DNS в имени сервера. То есть, субъект *.example.com совпадает с именами сервера a.example.com и b.example.com, но не совпадает с example.com или a.b.example.com.</p>

<h5><a name="section-3.1.3.2">3.1.3.2</a>. Сравнение IP-адресов</h5>

<p>Когда заявляемая идентификационная сущность представляет собой IP-адрес, она должна (MUST) быть преобразована в бинарное строковое представление "сетевой порядок байтов" ("network byte order") [<a href="http://rfc2.ru/791.rfc" title="Протокол IP">RFC791</a>][<a href="http://rfc2.ru/2460.rfc" title="Спецификация протокола IPv6">RFC2460</a>]. Для IPv4, как определено в <a href="http://rfc2.ru/791.rfc">RFC791</a>, строка байт должна содержать ровно 4 октета. Для IPv6, как определено в <a href="http://rfc2.ru/2460.rfc">RFC2460</a>, строка байт должна содержать ровно 16 октетов. Затем данная строка октетов сравнивается со значениями поля subjectAltName типа iPAddress. Совпадение имеет место, если строка октетов заявляемой идентификационной сущности и строка октетов значения идентичны.</p>

<h5><a name="section-3.1.3.3">3.1.3.3</a>. Сравнение других типов subjectName</h5>

<p>Реализации клиента могут (MAY) поддерживать проверку совпадений со значениями поля subjectAltName других типов так, как это описывается в других документах.</p>

<h4><a name="section-3.1.4">3.1.4</a>. Оценка полученного в результате уровня обеспечения безопасности</h4>

<p>После того как уровень TLS установлен в сессии LDAP, каждая из сторон должна самостоятельно решить &mdash; стоит или нет продолжать его использовать, основываясь на локальной политике и достигнутом уровне обеспечения безопасности. Если какая-либо из сторон решает, что уровень обеспечения безопасности недостаточен для того, чтобы она могла продолжить использование установленного соединения, ей следует (SHOULD) снять уровень TLS сразу после завершения переговоров (повторных переговоров) TLS (смотрите <a href="rfc4511.html#section-4.14.3">раздел 4.14.3 RFC4511</a> и <a href="#section-3.2">раздел 3.2 ниже</a>). Реализации могут произвести повторную оценку уровня обеспечения безопасности в любой момент и, если выяснится, что он недостаточен, им следует снять уровень TLS.</p>

<h4><a name="section-3.1.5">3.1.5</a>. Обновление информации о возможностях сервера</h4>

<p>После того как уровень TLS установлен в сессии LDAP, клиенту следует (SHOULD) отбросить или обновить всю информацию о сервере, полученную до инициации переговоров TLS, а также ту, которая была получена без использования механизмов обеспечения безопасности. Это защищает от атак типа "человек посередине", при которых может быть подменена любая полученная до установления уровня TLS информация о возможностях сервера.</p>

<p>После установления уровня TLS сервер может опубликовать возможности, отличные от тех, что были опубликованы до этого. В частности, могут измениться значения атрибута 'supportedSASLMechanisms' (например, желательно, чтобы механизмы EXTERNAL и PLAIN [<a href="#ref-PLAIN" title="The Plain SASL Mechanism">PLAIN</a>] были перечислены только после установления уровня TLS).</p>

<h3><a name="section-3.2">3.2</a>. Влияние TLS на состояние авторизации</h3>

<p>Установление, изменение, и/или закрытие TLS может привести к тому, что состояние авторизации изменится на новое. Это обсуждается далее в <a href="#section-4">разделе 4</a>.</p>

<h3><a name="section-3.3">3.3</a>. Наборы шифров TLS</h3>

<p>При выборе наборов шифров TLS, пригодных для использования в заданных условиях, должен приниматься во внимание ряд факторов, в том числе:</p>
<ul>
<li>Способность шифров обеспечить адекватную защиту конфиденциальности для паролей и других данных, пересылаемых через транспортное соединение. Разработчикам клиентов и серверов следует осознавать, что некоторые наборы шифров TLS не обеспечивают защиту конфиденциальности, а другие наборы шифров, обеспечивающие защиту конфиденциальности, могут быть подвержены взлому с применением методов "грубой силы", особенно в свете постоянно возрастающей вычислительной мощности процессоров, сокращающей время, необходимое для успешного выполнения таких атак.</li>
<li>Разработчикам клиентов и серверов следует внимательно следить за тем, чтобы уровень конфиденциальности, обеспечиваемый набором шифров, соответствовал значимости защищаемых паролей или данных.</li>
<li>Уязвимость (или её отсутствие) набора шифров к атакам типа "человек посередине". Наборы шифров, нестойкие к атакам типа "человек посередине", не следует (SHOULD NOT) использовать для защиты паролей или конфиденциальных данных, если только конфигурация сети не сводит вероятность таких атак к минимуму.</li>
<li>После завершения переговоров TLS (первоначальных или последующих), обе стороны протокола должны независимо удостовериться, что предоставляемые принятым в ходе переговоров набором шифров сервисы обеспечения безопасности достаточны для предполагаемого использования данной сессии LDAP. Если это не так, уровень TLS должен быть закрыт.</li>
</ul>
<h2><a name="section-4">4</a>. Состояние авторизации</h2>

<p>У каждой сессии LDAP есть ассоциированное с ней состояние авторизации. Это состояние зависит от многих факторов, в том числе какое состояние аутентификации было установлено (и было ли установлено какое-либо), каким образом оно было установлено, и какие сервисы обеспечения безопасности активны. Некоторые факторы могут быть определены и/или обусловлены событиями протокола (например, операциями Bind, StartTLS или закрытием TLS), а некоторые могут определяться внешними событиями (например, временем дня или нагрузкой на сервер).</p>

<p>Хотя зачастую удобно рассматривать состояние авторизации в упрощённых понятиях, таких как "анонимное состояние" (мы сами часто так поступаем в данной технической спецификации), следует иметь ввиду, что системы авторизации в реализациях LDAP обычно вовлекают в рассмотрение множество факторов, комплексно взаимодействующих друг с другом.</p>

<p>Авторизация в LDAP&thinsp;&mdash;&thinsp;это задача, решаемая локально. Одним из ключевых факторов при принятии решения по авторизации является авторизационная идентификационная сущность. Операция подсоединения Bind (определённая в <a href="rfc4511.html#section-4.2">разделе 4.2 RFC4511</a> и обсуждаемая далее в <a href="#section-5">разделе 5 этого документа</a>) позволяет обмениваться информацией между клиентом и сервером в целях установления авторизационной идентификационной сущности для сессии LDAP. Операция Bind может также использоваться для перехода сессии LDAP в анонимное состояние авторизации (смотрите <a href="#section-5.1.1">раздел 5.1.1</a>).</p>

<p>При первоначальном установлении сессии LDAP эта сессия имеет анонимную авторизационную идентификационную сущность. Среди прочего это означает, что от клиента не требуется посылать запрос BindRequest в первом PDU уровня сообщений LDAP. Клиент может посылать запросы любых операций до выполнения операции Bind, а сервер должен (MUST) интерпретировать их так, как если бы они были выполнены после анонимной операции Bind (<a href="#section-5.1.1">раздел 5.1.1</a>).</p>  

<p>После получения запроса Bind сервер немедленно переводит текущую сессию в анонимное состояние авторизации. Если запрос Bind выполнен успешно, сессия переходит в запрашиваемое состояние аутентификации и в связанное с ним состояние авторизации. В противном случае сессия остается в анонимном состоянии.</p>

<p>Имейте ввиду, что и другие события, как внутренние так и внешние по отношению к LDAP, могут приводить к тому, что состояния аутентификации и авторизации изменятся на анонимные. Например, установление, изменение или закрытие сервисов обеспечения безопасности данных может привести к переходу в анонимное состояние, либо может истечь срок действия удостоверяющих данных пользователя (например, сертификата). В первом случае мы получаем внутреннее по отношению LDAP событие, во втором&thinsp;&mdash;&thinsp;внешнее.</p>

<h2><a name="section-5">5</a>. Операция подсоединения Bind</h2>

<p>Операция Bind (<a href="rfc4511.html#section-4.2">раздел 4.2 RFC4511</a>) позволяет обмениваться аутентификационной информацией между клиентом и сервером для установления нового состояния авторизации.</p>

<p>В запросе Bind обычно указывается требуемая аутентификационная идентификационная сущность. Некоторые механизмы Bind также позволяют клиенту указать авторизационную идентификационную сущность. Если авторизационная идентификационная сущность не указана, сервер получает её из аутентификационной идентификационной сущности специфичным для реализации образом.</p>

<p>Если авторизационная идентификационная сущность указана, сервер должен (MUST) проверить, что аутентификационной идентификационной сущности клиента разрешено принимать на себя заявленную авторизационную идентификационную сущность (например, выступать для неё в качестве прокси). Если у клиента нет таких полномочий, сервер должен (MUST) отклонить операцию Bind с результирующим кодом invalidCredentials в ответе Bind.</p>

<h3><a name="section-5.1">5.1</a>. Метод простой аутентификации</h3>

<p>Метод простой аутентификации операции Bind предоставляет три механизма аутентификации:</p>
<ul>
<li>Механизм анонимной аутентификации (<a href="#section-5.1.1">раздел 5.1.1</a>).</li>
<li>Механизм аутентификации без проверки подлинности (<a href="#section-5.1.2">раздел 5.1.2</a>).</li>
<li>Механизм аутентификации по имени пользователя и паролю с использованием удостоверяющих данных, состоящих из имени (в форме уникального имени LDAP [<a href="http://tools.ietf.org/html/rfc4514" title="LDAP: String Representation of Distinguished Names">RFC4514</a>]) и пароля (<a href="#section-5.1.3">раздел 5.1.3</a>).</li>
</ul>
<h4><a name="section-5.1.1">5.1.1</a>. Простое подсоединение: механизм анонимной аутентификации</h4>

<p>LDAP-клиент может использовать механизм анонимной аутентификации метода простого подсоединения для того, чтобы явно установить анонимное состояние авторизации. Для этого он отправляет запрос Bind, поле name которого имеет значение нулевой длины, а в поле authentication указан механизм simple и значение пароля нулевой длины.</p>

<h4><a name="section-5.1.2">5.1.2</a>. Простое подсоединение: механизм аутентификации без проверки подлинности</h4>

<p>LDAP-клиент может использовать механизм аутентификации без проверки подлинности метода простого подсоединения, чтобы установить анонимное состояние авторизации. Для этого он отправляет запрос Bind, поле name которого имеет значение ненулевой длины (уникальное имя в строковой форме LDAP [<a href="http://tools.ietf.org/html/rfc4514" title="LDAP: String Representation of Distinguished Names">RFC4514</a>]), а в поле authentication указан механизм simple и значение пароля нулевой длины.</p>

<p>Предоставленное клиентом значение уникального имени предназначено для использования только в целях трассировки (например, журналирования). Это значение не должно быть подвержено проверке подлинности или какой-либо другой проверке (в том числе и на то, что DN указывает на существующий объект каталога). Это значение не должно использоваться (прямо или косвенно) в целях авторизации.</p>

<p>Операции Bind без проверки подлинности могут иметь значительные проблемы безопасности (смотрите <a href="#section-6.3.1">раздел 6.3.1</a>). В частности, пользователи, намеревающиеся выполнить аутентификацию по имени пользователя и паролю, могут непреднамеренно предоставить пустой пароль, и это может привести к тому, что плохо реализованные клиенты выполнят запрос доступа без проверки подлинности. Клиенты должны (SHOULD) быть реализованы так, чтобы от пользователя требовалось явно указывать выбор механизма аутентификации без проверки подлинности отличными от ввода пустого пароля средствами. Клиентам следует (SHOULD) запретить ввод пустого пароля в пользовательском интерфейсе аутентификации по имени пользователя и паролю. Кроме того, серверам следует (SHOULD) по умолчанию возвращать неудачное завершение с результирующим кодом unwillingToPerform в ответ на запросы подсоединения без проверки подлинности.</p>

<h4><a name="section-5.1.3">5.1.3</a>. Простое подсоединение: механизм аутентификации по имени пользователя и паролю</h4>

<p>LDAP-клиент может использовать механизм аутентификации по имени пользователя и паролю метода простого подсоединения, чтобы установить аутентифицированное состояние авторизации. Для этого он отправляет запрос Bind, поле name которого имеет значение ненулевой длины (уникальное имя в строковой форме LDAP [<a href="http://tools.ietf.org/html/rfc4514" title="LDAP: String Representation of Distinguished Names">RFC4514</a>]), а в поле authentication указан механизм simple и значение пароля в форме OCTET STRING ненулевой длины.</p>

<p>Серверы, отображающие посылаемое в запросе Bind DN в запись каталога с ассоциированным набором из одного или нескольких паролей, используемых с этим механизмом, сравнивают предоставленный пароль с этим набором паролей. Представленный пароль считается верным, если он соответствует любому из этого набора.</p>

<p>Результирующий код invalidDNSyntax говорит о том, что DN, посылаемый как значение поля name, синтаксически неверен. Результирующий код invalidCredentials говорит о том, что данное DN синтаксически корректно, но не действительно для аутентификации, либо пароль неверен для данного DN, либо сервер по каким-то иным соображениям считает удостоверяющие данные недействительными. Результирующий код success говорит о том, что удостоверяющие данные верны и что сервер готов предоставить сервис субъекту, идентифицируемому этими удостоверяющими данными.</p>

<p>Для запросов Bind с механизмом аутентификации по имени пользователя и паролю, в которых указано значение имени нулевой длины и значение пароля ненулевой длины, поведение сервера не определено.</p>

<p>Механизм аутентификации по имени пользователя и паролю метода простого подсоединения не подходит для аутентификации в окружениях без обеспечения защиты конфиденциальности данных.</p>

<h3><a name="section-5.2">5.2</a>. Метод аутентификации SASL</h3>

<p>Метод аутентификации sasl операции Bind предоставляет средства для использования любого механизма SASL, в том числе механизмов аутентификации и других сервисов (например, сервисов защиты информации).</p>

<h4><a name="section-5.2.1">5.2.1</a>. SASL-профиль протокола</h4>

<p>LDAP позволяет проводить аутентификацию посредством любого механизма SASL [<a href="http://tools.ietf.org/html/rfc4422" title="Simple Authentication and Security Layer (SASL)">RFC4422</a>]. Поскольку в LDAP есть собственные методы анонимной аутентификации и аутентификации по имени пользователя и паролю (в открытом виде), механизмы SASL ANONYMOUS [<a href="http://tools.ietf.org/html/rfc4505" title="The Anonymous SASL Mechanism">RFC4505</a>] и PLAIN [<a href="#ref-PLAIN" title="The Plain SASL Mechanism">PLAIN</a>] обычно с LDAP не используются.</p>

<p>От каждого протокола, использующего сервисы SASL, требуется предоставлять определённую информацию, в совокупности представляющую собой профиль того, как эти сервисы вписываются в работу протокола (<a href="http://tools.ietf.org/html/rfc4422#section-4">раздел 4 RFC4422</a>). В этом разделе объясняется, как эти требования профилирования удовлетворяются в LDAP.</p>

<h5><a name="section-5.2.1.1">5.2.1.1</a>. Имя сервиса SASL для LDAP</h5>

<p>Зарегистрированным IANA именем сервиса SASL для LDAP является "ldap".</p>

<h5><a name="section-5.2.1.2">5.2.1.2</a>. Инициация аутентификации и обмен сообщениями протокола SASL</h5>

<p>Инициация аутентификации SASL происходит посредством сообщения BindRequest (<a href="rfc4511.html#section-4.2">раздел 4.2 RFC4511</a>) со следующими параметрами:</p>
<ul>
<li>Версия&thinsp;&mdash;&thinsp;3.</li>
<li>AuthenticationChoice&thinsp;&mdash;&thinsp;sasl.</li>
<li>Элемент mechanism последовательности SaslCredentials содержит значение желаемого механизма SASL.</li>
<li>Опциональное поле credentials последовательности SaslCredentials может (MAY) быть использовано для предоставления первоначального отклика клиента в механизмах, в которых предусмотрено, что клиент отправляет данные первым (смотрите разделы <a href="http://tools.ietf.org/html/rfc4422#section-3">3</a> и <a href="http://tools.ietf.org/html/rfc4422#section-5">5</a> <a href="http://tools.ietf.org/html/rfc4422" title="Simple Authentication and Security Layer (SASL)">RFC4422</a>).</li>
</ul>
<p>В общем случае, обмен сообщениями протокола аутентификации SASL состоит из серии вызовов сервера и откликов клиента, содержимое которых специфично для механизма SASL и определяется им. Так, для некоторых механизмов аутентификации SASL, от клиента может потребоваться посылать отклик на один или несколько вызовов сервера путём отправки сообщений BindRequest несколько раз. Вызов обозначается отправкой сервером сообщения BindResponse с результирующим кодом saslBindInProgress. Это означает, что для продолжения процесса аутентификации сервер требует от клиента отправки нового сообщения BindRequest с тем же механизмом SASL.</p>

<p>С точки зрения уровня сообщений LDAP эти вызовы и отклики представляют собой неразбираемые бинарные токены произвольной длины. Серверы LDAP используют поле serverSaslCreds (OCTET STRING) в сообщении BindResponse для транспортировки каждого из вызовов. Клиенты LDAP используют поле credentials (OCTET STRING) в последовательности SaslCredentials сообщения BindRequest для транспортировки каждого из откликов. Имейте ввиду, что в отличие от некоторых протоколов Интернет, в которых используется SASL, LDAP не является текстовым и не выполняет Base64-трансформации значений этих вызовов и откликов.</p>

<p>Клиентам, посылающим сообщение BindRequest с выбранным пунктом sasl, следует (SHOULD) отправлять значение нулевой длины в поле name. Серверам, получающим сообщение BindRequest с выбранным пунктом sasl, нужно (SHALL) игнорировать любое значение в поле name.</p>

<p>Клиент может прервать переговоры Bind SASL путём отправки сообщения BindRequest с другим значением в поле mechanism последовательности SaslCredentials, либо отличным от sasl пунктом в конструкции AuthenticationChoice.</p>

<p>Если клиент посылает сообщение BindRequest с выбранным пунктом sasl и пустой строкой в поле mechanism, сервер должен (MUST) вернуть сообщение BindResponse с результирующим кодом authMethodNotSupported. Это позволяет клиенту прервать переговоры, если он желает вновь попробовать пройти аутентификацию с тем же механизмом SASL.</p>

<p>Сервер указывает на завершение обмена вызовами-откликами SASL путём посылки ответа BindResponse, в котором значение результирующего кода отлично от saslBindInProgress.</p>

<p>В этом сообщении BindResponse поле serverSaslCreds может быть использовано для включения опционального вызова с уведомлением об успешном завершении для тех механизмов, в определении которых сказано, что сервер посылает дополнительные данные вместе с указанием успешного завершения.</p>

<h5><a name="section-5.2.1.3">5.2.1.3</a>. Опциональные поля</h5>

<p>Как уже было сказано, LDAP предоставляет опциональное поле для передачи первоначального отклика в сообщении, инициирующем обмен SASL, а также опциональное поле для передачи дополнительной информации в сообщении, указывающем на завершение аутентификационного обмена. Специфичное для механизма содержимое в этих полях может быть нулевой длины. SASL требует, чтобы в протоколе были спецификации, раскрывающие, каким образом поле нулевой длины отличить от отсутствия этого поля.</p>

<p>Данные первоначального отклика нулевой длины отличаются от отсутствия данных первоначального отклика в инициирующем сообщении (BindRequest PDU) наличием в этом PDU строки октетов (OCTET STRING) SaslCredentials.credentials нулевой длины. Если клиент не собирается отправлять первоначальный отклик в сообщении BindRequest, инициирующем обмен SASL, он должен (MUST) опустить строку октетов SaslCredentials.credentials (вместо того, чтобы включать строку октетов нулевой длины).</p>

<p>Дополнительные данные нулевой длины отличаются от отсутствия дополнительных ответных данных в итоговом сообщении (BindResponse PDU) наличием в этом PDU строки октетов (OCTET STRING) serverSaslCreds нулевой длины. Если сервер не собирается отправлять дополнительные данные в сообщении BindResponse, указывающем на окончание аутентификационного обмена, он должен (SHALL) опустить строку октетов serverSaslCreds (вместо того, чтобы включать строку октетов нулевой длины).</p>

<h5><a name="section-5.2.1.4">5.2.1.4</a>. Октет, с которого вступают в силу уровни безопасности</h5>

<p>Уровень SASL вступает в силу вслед за передачей сервером и приёмом клиентом финального в обмене SASL сообщения BindResponse с результирующим кодом success.</p>

<p>После того, как уровень SASL, предоставляющий сервисы обеспечения целостности или конфиденциальности данных, вступил в силу, он остаётся в силе до тех пор, пока не будет установлен новый уровень (то есть, до первого октета, следующего за финальным сообщением BindResponse операции Bind, в результате которой вступил в силу новый уровень).  Таким образом, на установленный уровень SASL не влияют завершившиеся неудачей или не-SASL операции Bind.</p>

<h5><a name="section-5.2.1.5">5.2.1.5</a>. Определение поддерживаемых механизмов SASL</h5>

<p>Клиенты могут определить поддерживаемые сервером механизмы SASL путём считывания атрибута 'supportedSASLMechanisms' из записи корневой DSE (DSA-Specific Entry) (<a href="rfc4512.html#section-5.1">раздел 5.1 RFC4512</a>). В значениях этого атрибута, если таковые имеются, перечисляются поддерживаемые сервером в текущем состоянии сессии LDAP механизмы.  LDAP-серверам следует (SHOULD) разрешать всем клиентам&thinsp;&mdash;&thinsp;даже с анонимной авторизацией&thinsp;&mdash;&thinsp;получать атрибут 'supportedSASLMechanisms' корневой DSE как до, так и после аутентификационного обмена SASL. Цель повторного получения поддерживаемых механизмов после установления уровня SASL&thinsp;&mdash;&thinsp;позволить клиентам выявить возможные атаки типа <a href="https://ru.wikipedia.org/wiki/%D0%A7%D0%B5%D0%BB%D0%BE%D0%B2%D0%B5%D0%BA_%D0%BF%D0%BE%D1%81%D0%B5%D1%80%D0%B5%D0%B4%D0%B8%D0%BD%D0%B5#Downgrade_Attack">"downgrade attack"</a> (смотрите <a href="#section-6.4">раздел 6.4</a> этого документа и <a href="http://tools.ietf.org/html/rfc4422#section-6.1.2">раздел 6.1.2 RFC4422</a>).</p>

<p>Поскольку механизмы SASL обеспечивают критические функции безопасности, клиентам и серверам следует иметь возможность настройки таким образом, чтобы указать, какие механизмы являются приемлемыми, и разрешать использовать только эти механизмы. Перед началом использования сессии и клиенты, и серверы должны убедиться, что установленный уровень обеспечения безопасности удовлетворяет их требованиям.</p>

<h5><a name="section-5.2.1.6">5.2.1.6</a>. Правила использования уровней SASL</h5>

<p>После установки уровня SASL клиенту следует (SHOULD) отбросить или обновить всю информацию о сервере, полученную им до начала переговоров SASL, а также полученную без использования защитных механизмов.</p>

<p>Если безопасность обеспечивается более низкоуровневыми средствами (такими, как TLS), любой уровень SASL должен (SHALL) работать поверх таких уровней обеспечения безопасности, независимо от того, в каком порядке они были установлены. Во всем остальном уровень SASL и другие уровни обеспечения безопасности функционируют независимо друг от друга. Например, если одновременно действуют и уровень TLS, и уровень SASL, то снятие уровня TLS не влияет на продолжение работы уровня SASL.</p>

<h5><a name="section-5.2.1.7">5.2.1.7</a>. Поддержка множественной аутентификации</h5>

<p>LDAP поддерживает множественную аутентификацию SASL согласно определению, приведённому в <a href="http://tools.ietf.org/html/rfc4422#section-4">разделе 4 RFC4422</a>.</p>

<h5><a name="section-5.2.1.8">5.2.1.8</a>. Авторизационные идентификационные сущности SASL</h5>

<p>Некоторые механизмы SASL позволяют клиентам запрашивать для сессии LDAP желаемую авторизационную идентификационную сущность (<a href="http://tools.ietf.org/html/rfc4422#section-3.4">раздел 3.4 RFC4422</a>). Решение о том, позволять или не позволять текущей аутентификационной идентификационной сущности получать доступ от имени запрашиваемой авторизационной идентификационной сущности возлагается на локальную политику. Авторизационная идентификационная сущность представляет собой строку символов [<a href="#ref-Unicode" title="The Unicode Standard, Version 3.2.0">Unicode</a>], закодированную UTF-8 [<a href="http://tools.ietf.org/html/rfc3629" title="UTF-8, a transformation format of ISO 10646">RFC3629</a>], соответствующую грамматике, описанной следующей расширенной формой Бэкуса-Наура (ABNF) [<a href="http://tools.ietf.org/html/rfc4234" title="Augmented BNF for Syntax Specifications: ABNF">RFC4234</a>]:
<pre class="list">
      authzId = dnAuthzId / uAuthzId

      ; Авторизационная идентификационная сущность,
      ; основанная на уникальном имени (DN)
      dnAuthzId =  "dn:" distinguishedName

      ; Неопределённая авторизационная идентификационная
      ; сущность, закодированная UTF-8
      uAuthzId = "u:" userid
      userid = *UTF8 ; синтаксис не определён
</pre>
<p>Здесь правило distinguishedName определено в <a href="http://tools.ietf.org/html/rfc4514#section-3">разделе 3 RFC4514</a>, а правило UTF8 определено в <a href="rfc4512.html#section-1.4">разделе 1.4 RFC4512</a>.</p>

<p>Пункт dnAuthzId используется для заявления авторизационных идентификационных сущностей в форме уникального имени, которые должны сравниваться по правилу соответствия distinguishedNameMatch (<a href="http://tools.ietf.org/html/rfc4517#section-4.2.15">раздел 4.2.15 RFC4517</a>). Не выдвигается требование, чтобы заявляемое значение distinguishedName соответствовало имени реальной записи, хранящейся в каталоге.</p>

<p>Пункт uAuthzId позволяет клиентам заявлять авторизационную идентификационную сущность в форме, отличной от уникального имени. Формат значения userid определяется только как последовательность символов [<a href="#ref-Unicode" title="The Unicode Standard, Version 3.2.0">Unicode</a>], закодированных UTF-8 [<a href="http://tools.ietf.org/html/rfc3629" title="UTF-8, a transformation format of ISO 10646">RFC3629</a>], а дальнейшие интерпретации оставлены для решения на локальном уровне. Например, userid может идентифицировать пользователя конкретной службы каталогов, быть именем пользователя (логином) или адресом электронной почты. Не следует (SHOULD NOT) считать, что значение uAuthzId глобально уникально. Для сравнения значений uAuthzId каждое из них должно (MUST) быть подготовлено как строка "query" (<a href="http://tools.ietf.org/html/rfc3454#section-7">раздел 7 RFC3454</a>) с помощью алгоритма SASLprep [<a href="http://tools.ietf.org/html/rfc4013" title="SASLprep: Stringprep Profile for User Names and Passwords">RFC4013</a>], после чего два значения сравниваются побайтно.</p>

<p>Приведённая выше грамматика является расширяемой. Конструкция authzId может быть расширена для поддержки дополнительных форм идентификационных сущностей. Каждая форма отличается от других своим уникальным префиксом (регистрационные требования смотрите в <a href="http://tools.ietf.org/html/rfc4520#section-3.12">разделе 3.12 RFC4520</a>).</p>

<h4><a name="section-5.2.2">5.2.2</a>. Семантики SASL в LDAP</h4>

<p>Разработчики должны позаботиться о сохранении семантик спецификаций SASL при обработке данных, имеющих другие семантики в протоколе LDAP.</p>

<p>Например, механизм аутентификации SASL DIGEST-MD5 [<a href="#ref-DIGEST-MD5" title="Using Digest Authentication as a SASL Mechanism">DIGEST-MD5</a>] использует аутентификационную идентификационную сущность и область действия (realm), которые синтаксически представляют собой простые строки, а семантически&thinsp;&mdash;&thinsp;простые значения username [<a href="http://tools.ietf.org/html/rfc4013" title="SASLprep: Stringprep Profile for User Names and Passwords">RFC4013</a>] и realm. Эти значения не являются LDAP DN, и не требуется, чтобы они были представлены или рассматривались в качестве таковых.</p>

<h4><a name="section-5.2.3">5.2.3</a>. Механизм аутентификации SASL EXTERNAL</h4>

<p>Клиент может использовать механизм SASL EXTERNAL (<a href="http://tools.ietf.org/html/rfc4422#appendix-A">приложение A RFC4422</a>), чтобы запросить LDAP-сервер провести аутентификацию и установить результирующую авторизационную идентификационную сущность, используя защищённые удостоверяющие данные, обмен которыми произошёл на более низком уровне обеспечения безопасности (например, в ходе аутентификации TLS). Если клиент не предоставлял свои удостоверяющие данные аутентификации при установке более низкого уровня обеспечения безопасности, операция Bind с механизмом SASL EXTERNAL должна (MUST) завершиться неудачей с результирующим кодом inappropriateAuthentication. Хотя следствием этой ситуации является то, что сессия LDAP остаётся в анонимном состоянии (<a href="#section-4">раздел 4</a>), это не влияет на состояние каких-либо уже установленных уровней обеспечения безопасности.</p>

<p>Клиент может либо запросить, чтобы его авторизационная идентификационная сущность была автоматически получена из его удостоверяющих данных аутентификации, обмен которыми произошёл на более низком уровне обеспечения безопасности, либо явно предоставить желаемую авторизационную идентификационную сущность. Первый случай называется неявным заявлением авторизационной идентификационной сущности, второй&thinsp;&mdash;&thinsp;явным заявлением.</p>

<h5><a name="section-5.2.3.1">5.2.3.1</a>. Неявное заявление</h5>

<p>Неявное заявление авторизационной идентификационной сущности выполняется путём вызова запроса Bind в форме SASL с использованием имени EXTERNAL в поле mechanism и без указания опционального поля credentials (оба поля находятся в последовательности SaslCredentials сообщения BindRequest). Сервер будет получать авторизационную идентификационную сущность клиента из аутентификационной идентификационной сущности, предоставленной уровнем обеспечения безопасности (например, из сертификата открытого ключа, использованного во время установки уровня TLS) в соответствии с правилами локальной политики. Механизмы получения одной идентификационной сущности из другой зависят от реализации.</p>

<h5><a name="section-5.2.3.2">5.2.3.2</a>. Явное заявление</h5>

<p>Явное заявление авторизационной идентификационной сущности выполняется путём вызова запроса Bind в форме SASL с использованием имени EXTERNAL в поле mechanism и с указанием опционального поля credentials (оба поля находятся в последовательности SaslCredentials сообщения BindRequest). Значением поля credentials (OCTET STRING) является заявляемая авторизационная идентификационная сущность, которая должна (MUST) быть построена так, как описано в <a href="#section-5.2.1.8">разделе 5.2.1.8</a>.</p>

<h2><a name="section-6">6</a>. О безопасности</h2>

<p>Весь этот документ посвящён обсуждению вопросов безопасности. Очевидно, что безопасность является неотъемлемой частью LDAP. В этом разделе также обсуждается ряд связанных с LDAP вопросов безопасности.</p>

<h3><a name="section-6.1">6.1</a>. Общие соображения безопасности, касающиеся LDAP</h3>

<p>Сам по себе LDAP не обеспечивает защиту от доступа или обновления каталога средствами, отличными от выполнения операций протокола LDAP, например, от просмотра файлов базы данных сервера администраторами базы данных.</p>

<p>Конфиденциальная информация может содержаться практически в любом сообщении LDAP и её раскрытие может попадать под действие законов о защите персональных данных или других правовых актов во многих странах. Разработчикам следует принимать надлежащие меры для защиты конфиденциальной информации от её раскрытия несанкционированными лицами.</p>

<p>Сессия, в которой клиент не установил сервисов обеспечения целостности и конфиденциальности данных (например, средствами StartTLS, IPsec или соответствующего механизма SASL), может быть подвержена атакам типа "человек посередине" с целью просмотра и модификации информации в процессе её передачи. Разработчикам клиентов и серверов следует (SHOULD) принимать меры для защиты конфиденциальной информации в сессии LDAP от подобных атак путём использования сервисов защиты, как это обсуждалось в данном документе. Клиентам и серверам следует обеспечить возможность настройки таким образом, чтобы установление защитных мер было необходимым условием организации работы. Результирующий код confidentialityRequired предназначен для указания на то, что для выполнения запрашиваемой операции сервер требует установления (более строгой) защиты конфиденциальности данных.</p>

<p>При чтении конфиденциальной информации или обновлении информации каталога всегда должен применяться контроль доступа.</p>

<p>Различные факторы, влияющие на безопасность, в том числе информация, касающаяся аутентификации и авторизации, а также сервисы обеспечения безопасности данных могут изменяться в ходе одного и того же сеанса LDAP или даже в ходе выполнения одной конкретной операции. Реализациям следует адекватно обрабатывать изменения факторов безопасности.</p>

<h3><a name="section-6.2">6.2</a>. Соображения безопасности, касающиеся операции StartTLS</h3>

<p>Безопасность, достигаемая за счёт использования операции StartTLS, целиком и полностью является безопасностью, достигаемой за счёт использования самого TLS. Сама по себе операция StartTLS не предоставляет никаких дополнительных возможностей обеспечения безопасности.</p>

<p>Уровень безопасности, обеспечиваемый за счёт использования TLS, напрямую зависит как от качества используемой реализации TLS, так и от стиля использования этой реализации. Кроме того, злоумышленник, производящий атаку "человек посередине", может удалить расширенную операцию StartTLS из значений атрибута 'supportedExtension' корневой DSE. Обеим сторонам следует (SHOULD) независимо удостовериться и согласиться с уровнем безопасности, полученным в результате установления TLS, и сделать это до начала использования сессии, защищённой TLS. Например, может так произойти, что полученный в результате переговоров TLS уровень безопасности может ничем не превосходить передачу открытым текстом.</p>

<p>Клиенты должны (MUST) либо предупредить пользователя, если достигнутый уровень безопасности не обеспечивает приемлемого уровня защиты конфиденциальности и/или целостности данных, либо иметь возможность настройки таким образом, чтобы отказаться от продолжения работы, если не обеспечен приемлемый уровень безопасности.</p>

<p>Как сказано в <a href="#section-3.1.2">разделе 3.1.2</a>, сервер может использовать локальную политику для определения того, успешно ли завершены переговоры TLS.   Администратору политики следует использовать информацию из сертификата пользователя, сгенерированного удостоверяющим центром или проверенного с его помощью, при настройке политик идентификации и авторизации.</p>

<p>Разработчикам серверов следует (SHOULD) разрешить администраторам сервера выбирать, требуется ли обеспечивать конфиденциальность и целостность данных и когда это необходимо делать, а также требуется ли аутентификация клиента в ходе переговоров TLS.</p>

<p>Разработчикам следует быть осведомленными и понимать соображения безопасности TLS, обсуждаемые в спецификации TLS [<a href="http://tools.ietf.org/html/rfc4346" title="The TLS Protocol Version 1.1">RFC4346</a>].</p>

<h3><a name="section-6.3">6.3</a>. Соображения безопасности, касающиеся операции Bind</h3>

<p>В этом разделе обсуждается несколько вопросов безопасности по аутентификации LDAP средствами операции Bind.</p>

<h4><a name="section-6.3.1">6.3.1</a>. Соображения безопасности, касающиеся механизма аутентификации без проверки подлинности</h4>

<p>Опыт работы показывает, что клиенты могут (и часто так и поступают) неправильно использовать механизм аутентификации без проверки подлинности метода простого подсоединения (смотрите <a href="#section-5.1.2">раздел 5.1.2</a>). Например, программа-клиент может принять решение предоставить доступ к информации, не имеющей отношения к каталогу, на основании успешного выполнения операции Bind. Реализации LDAP-сервера могут вернуть успешный ответ на запрос Bind без проверки подлинности. Это может ввести клиента в заблуждение, что сервер произвёл успешную аутентификацию идентификационной сущности, представленной заданным уникальным именем, тогда как на самом деле было установлено анонимное состояние авторизации. Клиентам, использующим результаты операции простого подсоединения для принятия решения по авторизации, следует активно выявлять запросы Bind без проверки подлинности (проверяя, что предоставленный пароль не пуст) и реагировать соответствующим образом.</p>

<h4><a name="section-6.3.2">6.3.2</a>. Соображения безопасности, касающиеся механизма аутентификации по имени пользователя и паролю</h4>

<p>При использовании механизма аутентификации по имени пользователя и паролю метода простого подсоединения происходит раскрытие пароля серверу, что само по себе является риском безопасности. Существуют другие механизмы, такие как SASL <a href="#ref-DIGEST-MD5" title="Using Digest Authentication as a SASL Mechanism">DIGEST-MD5</a>, не раскрывающие пароль серверу.</p>

<h4><a name="section-6.3.3">6.3.3</a>. Соображения безопасности, связанные с паролями</h4>

<p>В LDAP разрешены многозначные парольные атрибуты. В системах, где записи должны иметь один и только один пароль, такое поведение должно обеспечиваться административными методами.</p>

<p>Использование паролей в открытом виде и других незащищённых удостоверяющих данных аутентификации настоятельно не рекомендуется в открытых сетях, когда транспортный сервис не может гарантировать конфиденциальности данных. Реализациям LDAP не следует (SHOULD NOT) по умолчанию поддерживать методы аутентификации с использованием паролей в открытом виде и других незащищённых удостоверяющих данных, если данные в сессии не защищены с помощью TLS или других методов защиты конфиденциальности и целостности данных.</p>

<p>Передача паролей в открытом виде,&thinsp;&mdash;&thinsp;обычно для аутентификации или модификации,&thinsp;&mdash;&thinsp;представляет собой значительный риск безопасности. Этого риска можно избежать путём использования механизмов аутентификации SASL [<a href="http://tools.ietf.org/html/rfc4422" title="Simple Authentication and Security Layer (SASL)">RFC4422</a>], не передающих пароли в открытом виде, либо установлением сервисов обеспечения конфиденциальности на транспортном уровне или на уровне сессии перед тем, как передавать значения паролей.</p>

<p>Чтобы снизить связанные с передачей паролей риски безопасности, реализация сервера, поддерживающая любые механизмы аутентификации на основе паролей, передающие пароли в открытом виде, должна (MUST) поддерживать механизм обеспечения такой политики, когда во время аутентификации или модификации пароля обязательными для выполнения были бы следующие условия:</p>
<blockquote>
<p>Был успешно установлен уровень TLS.</p>
<p>ИЛИ</p>
<p>Был установлен какой-либо другой механизм обеспечения конфиденциальности данных, защищающий значения паролей от перехвата.</p>
<p>ИЛИ</p>
<p>Сервер возвращает результирующий код confidentialityRequired для такой операции (то есть, операции простого подсоединения Bind с передачей парольного значения, операции SASL Bind, передающей парольное значение в открытом виде, операции добавления или модификации, включающих значения атрибута userPassword, и т.д.), даже если значение пароля было корректным.</p>
</blockquote>
<p>Реализации сервера также могут предоставлять механизмы обеспечения политик, при которых учётные данные признаются недействительными или защищаются каким-либо иным образом, если сервер определяет, что пароль для учётной записи был передан в открытом виде.</p>

<h4><a name="section-6.3.4">6.3.4</a>. Соображения безопасности по хэшированным паролям</h4>

<p>Некоторые механизмы аутентификации (например, DIGEST-MD5) передают по сети хэши значений паролей, которые могут быть уязвимы к оффлайн-атакам по словарю. Разработчикам следует позаботиться о защите таких хэшированных значений паролей во время их передачи по сети с помощью TLS или других механизмов обеспечения конфиденциальности данных.</p>

<h3><a name="section-6.4">6.4</a>. Соображения безопасности, связанные с SASL</h3>

<p>До того момента, пока в сессии LDAP не установлены сервисы обеспечения целостности данных, злоумышленник может модифицировать передаваемые по сети ответы сервера со значениями атрибута 'supportedSASLMechanisms', и таким образом понизить качество доступных в списке механизмов SASL, включив в него только наименее безопасные механизмы. Для выявления этого типа атак клиент может запросить доступные на сервере механизмы SASL как до, так и после установления в сессии LDAP сервисов обеспечения целостности данных. Если клиент обнаруживает, что список с обеспечением защиты целостности (то есть полученный после установления сервисов защиты целостности) содержит более строгие механизмы, чем полученный ранее, ему следует считать, что полученный ранее список был модифицирован злоумышленником. В этих условиях клиенту рекомендуется закрыть лежащее в основе сессии транспортное соединение и выполнить переподключение для повторной установки сессии.</p>

<h3><a name="section-6.5">6.5</a>. Другие соображения безопасности по теме</h3>

<p>Дополнительные соображения безопасности, относящиеся к различным обсуждаемым в этом документе механизмам и методам аутентификации, можно найти в [<a href="http://tools.ietf.org/html/rfc4422" title="Simple Authentication and Security Layer (SASL)">RFC4422</a>], [<a href="http://tools.ietf.org/html/rfc4013" title="SASLprep: Stringprep Profile for User Names and Passwords">RFC4013</a>], [<a href="http://tools.ietf.org/html/rfc3454" title="Preparation of Internationalized Strings">RFC3454</a>] и [<a href="http://tools.ietf.org/html/rfc3629" title="UTF-8, a transformation format of ISO 10646">RFC3629</a>].</p>

<h2><a name="section-7">7</a>. Регистрация в IANA</h2>

<p>IANA обновила регистрацию механизма протокола LDAP, указав тем самым, что в данном документе и в [<a href="rfc4511.html" title="LDAP: Определение протокола">RFC4511</a>] предоставлена окончательная техническая спецификация для расширенной операции StartTLS (1.3.6.1.4.1.1466.20037).</p>

<p>IANA обновила регистрацию типов LDAPMessage LDAP, указав тем самым, что в данном документе и в [<a href="rfc4511.html" title="LDAP: Определение протокола">RFC4511</a>] предоставлена окончательная техническая спецификация для типов сообщений bindRequest (0) и bindResponse (1).</p>

<p>IANA обновила регистрацию метода аутентификации Bind LDAP, указав тем самым, что в данном документе и в [<a href="rfc4511.html" title="LDAP: Определение протокола">RFC4511</a>] предоставлена окончательная техническая спецификация для методов аутентификации simple (0) и sasl (3) операции подсоединения.</p>

<p>IANA обновила регистрацию префиксов authzid LDAP, указав тем самым, что в данном документе предоставлена окончательная техническая спецификация для префиксов authzid dnAuthzId (dn:) и uAuthzId (u:).</p>

<h2><a name="section-8">8</a>. Благодарности</h2>

<p>Этот документ объединяет в себе информацию, изначально содержавшуюся в <a href="http://tools.ietf.org/html/rfc2251">RFC 2251</a>,  <a href="http://tools.ietf.org/html/rfc2829">RFC 2829</a> и <a href="http://tools.ietf.org/html/rfc2830">RFC 2830</a>.  <a href="http://tools.ietf.org/html/rfc2251">RFC 2251</a>&thinsp;&mdash;&thinsp;продукт рабочей группы Access, Searching and Indexing of Directories (ASID).  <a href="http://tools.ietf.org/html/rfc2829">RFC 2829</a> и <a href="http://tools.ietf.org/html/rfc2830">RFC 2830</a>&thinsp;&mdash;&thinsp;продукты рабочей группы LDAP Extensions (LDAPEXT).</p>

<p>Данный документ&thinsp;&mdash;&thinsp;продукт рабочей группы IETF LDAP Revision (LDAPBIS).</p>

<h2><a name="section-9">9</a>. Нормативные документы</h2>

<p>[<a name="ref-RFC791" id="ref-RFC791">RFC791</a>] Postel, J., "Протокол IP", STD 5, <a href="http://rfc2.ru/791.rfc">RFC 791</a>, сентябрь 1981 г.</p>

<p>[<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>] Bradner, S., "Ключевые слова для обозначения уровня требований в RFC", <a href="http://rfc2.ru/2119.rfc">BCP 14</a>, <a href="http://rfc2.ru/2119.rfc">RFC 2119</a>, март 1997 г.</p>

<p>[<a name="ref-RFC2460" id="ref-RFC2460">RFC2460</a>] Deering, S. и R. Hinden, "Спецификация протокола IPv6", <a href="http://rfc2.ru/2460.rfc">RFC 2460</a>, декабрь 1998 г.</p>

<p>[<a name="ref-RFC3454" id="ref-RFC3454">RFC3454</a>] Hoffman, P. и M. Blanchet, "Preparation of Internationalized Strings ("stringprep")", <a href="http://tools.ietf.org/html/rfc3454">RFC 3454</a>, декабрь 2002 г.</p>

<p>[<a name="ref-RFC3490" id="ref-RFC3490">RFC3490</a>] Faltstrom, P., Hoffman, P. и A. Costello, "Internationalizing Domain Names in Applications (IDNA)", <a href="http://tools.ietf.org/html/rfc3490">RFC 3490</a>, март 2003 г.</p>

<p>[<a name="ref-RFC3629" id="ref-RFC3629">RFC3629</a>] Yergeau, F., "UTF-8, a transformation format of ISO 10646", STD 63, <a href="http://tools.ietf.org/html/rfc3629">RFC 3629</a>, ноябрь 2003 г.</p>

<p>[<a name="ref-RFC4013" id="ref-RFC4013">RFC4013</a>] Zeilenga, K., "SASLprep: Stringprep Profile for User Names and Passwords", <a href="http://tools.ietf.org/html/rfc4013">RFC 4013</a>, февраль 2005 г.</p>

<p>[<a name="ref-RFC4234" id="ref-RFC4234">RFC4234</a>] Crocker, D. и P. Overell, "Augmented BNF for Syntax Specifications: ABNF", <a href="http://tools.ietf.org/html/rfc4234">RFC 4234</a>, октябрь 2005 г.</p>

<p>[<a name="ref-RFC4346" id="ref-RFC4346">RFC4346</a>] Dierks, T. и E. Rescorla, "The TLS Protocol Version 1.1", <a href="http://tools.ietf.org/html/rfc4346">RFC 4346</a>, март 2006 г.</p>

<p>[<a name="ref-RFC4422" id="ref-RFC4422">RFC4422</a>] Под редакцией Melnikov, A. и K. Zeilenga, "Simple  Authentication and Security Layer (SASL)", <a href="http://tools.ietf.org/html/rfc4422">RFC 4422</a>, июнь 2006 г.</p>

<p>[<a name="ref-RFC4510" id="ref-RFC4510">RFC4510</a>] Под редакцией Zeilenga, K., "Lightweight Directory Access Protocol (LDAP): Technical Specification Road Map", <a href="http://tools.ietf.org/html/rfc4510">RFC</a> <a href="http://tools.ietf.org/html/rfc4510">4510</a>, июнь 2006 г.</p>

<p>[<a name="ref-RFC4511" id="ref-RFC4511">RFC4511</a>] Под редакцией Sermersheim, J., "Lightweight Directory Access Protocol (LDAP): Определение протокола", <a href="rfc4511.html">RFC 4511</a>, июнь 2006 г.</p>

<p>[<a name="ref-RFC4512" id="ref-RFC4512">RFC4512</a>] Zeilenga, K., "Lightweight Directory Access Protocol (LDAP): Информационные модели каталога", <a href="rfc4512.html">RFC 4512</a>, июнь 2006 г.</p>

<p>[<a name="ref-RFC4514" id="ref-RFC4514">RFC4514</a>] Под редакцией Zeilenga, K., "Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names", <a href="http://tools.ietf.org/html/rfc4514">RFC 4514</a>, июнь 2006 г.</p>

<p>[<a name="ref-RFC4517" id="ref-RFC4517">RFC4517</a>] Под редакцией Legg, S., "Lightweight Directory Access Protocol (LDAP): Syntaxes and Matching Rules", <a href="http://tools.ietf.org/html/rfc4517">RFC 4517</a>, июнь 2006 г.</p>

<p>[<a name="ref-RFC4519" id="ref-RFC4519">RFC4519</a>] Под редакцией Sciberras, A., "Lightweight Directory Access Protocol (LDAP): Schema for User Applications", <a href="http://tools.ietf.org/html/rfc4519">RFC</a> <a href="http://tools.ietf.org/html/rfc4519">4519</a>, июнь 2006 г.</p>

<p>[<a name="ref-RFC4520" id="ref-RFC4520">RFC4520</a>] Zeilenga, K., "Internet Assigned Numbers Authority (IANA) Considerations for the Lightweight Directory              Access Protocol (LDAP)", <a href="http://tools.ietf.org/html/rfc4520">BCP 64</a>, <a href="http://tools.ietf.org/html/rfc4520">RFC 4520</a>, июнь 2006 г.</p>

<p>[<a name="ref-Unicode" id="ref-Unicode">Unicode</a>] The Unicode Consortium, "The Unicode Standard, Version 3.2.0" is defined by "The Unicode Standard, Version 3.0" (Reading, MA, Addison-Wesley, 2000.  ISBN 0-201-61633-5), as amended by the "Unicode Standard Annex #27: Unicode 3.1" (<a href="http://www.unicode.org/reports/tr27/">http://www.unicode.org/reports/tr27/</a>) and by the "Unicode Standard Annex #28: Unicode 3.2" (<a href="http://www.unicode.org/reports/tr28/">http://www.unicode.org/reports/tr28/</a>).</p>

<p>[<a name="ref-X.501" id="ref-X.501">X.501</a>] ITU-T Rec. X.501, "The Directory: Models", 1993 г.</p>

<h2><a name="section-10">10</a>. Информативные документы</h2>

<p>[<a name="ref-DIGEST-MD5" id="ref-DIGEST-MD5">DIGEST-MD5</a>] Leach, P., Newman, C. и A. Melnikov, "Using Digest Authentication as a SASL Mechanism", работы продолжаются, март 2006 г.</p>

<p>[<a name="ref-PLAIN" id="ref-PLAIN">PLAIN</a>]  Zeilenga, K., <a style="text-decoration: none" href='http://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22The+Plain+SASL+Mechanism%22'>"The Plain SASL Mechanism"</a>, работы продолжаются, март 2005 г.</p>

<p>[<a name="ref-RFC2828" id="ref-RFC2828">RFC2828</a>] Shirey, R., "Internet Security Glossary", FYI 36, <a href="http://tools.ietf.org/html/rfc2828">RFC2828</a>, май 2000 г.</p>

<p>[<a name="ref-RFC4301" id="ref-RFC4301">RFC4301</a>] Kent, S. и K. Seo, "Security Architecture for the  Internet Protocol", <a href="http://tools.ietf.org/html/rfc4301">RFC 4301</a>, декабрь 2005 г.</p>

<p>[<a name="ref-RFC4505" id="ref-RFC4505">RFC4505</a>] Zeilenga, K., "The Anonymous SASL Mechanism", <a href="http://tools.ietf.org/html/rfc4505">RFC 4505</a>,             июнь 2006 г.</p>

<h2><a name="appendix-A">Приложение A</a>. Концепции аутентификации и авторизации</h2>

<p>Это приложение не является нормативным.</p>

<p>В этом приложении определены основные термины, концепции и связанные с ними понятия, касающиеся аутентификации, авторизации, удостоверяющих данных и подтверждения подлинности. Эти понятия используются при описании того, как различные подходы к обеспечению безопасности используются в аутентификации и авторизации клиента.</p>

<h3><a name="appendix-A.1">A.1</a>. Политика контроля доступа</h3>

<p>Политика контроля доступа&thinsp;&mdash;&thinsp;это набор правил, определяющих защиту ресурсов, обычно с точки зрения возможностей людей или иных субъектов получить доступ к этим ресурсам. Объекты и механизмы обеспечения безопасности, описанные в том числе и в этом приложении, предназначены для выражения политик контроля доступа и обеспечения их выполнения.</p>

<h3><a name="appendix-A.2">A.2</a>. Факторы контроля доступа</h3>

<p>Запросы, при их обработке сервером, могут быть ассоциированы с широким спектром факторов, связанных с безопасностью. Сервер использует эти факторы, чтобы определить, стоит ли вообще обрабатывать запрос, и, если да, то как его обрабатывать. Эти факторы называются факторами контроля доступа (access control factors, ACFs). Они могут включать в себя IP-адрес источника запроса, стойкость шифрования, тип запрашиваемой операции, время дня и т.п. Некоторые факторы могут зависеть от специфики конкретного запроса; другие могут быть связаны с транспортным соединением, по которому передаётся запрос; наконец, некоторые (например, время дня) могут "зависеть от окружения".</p>

<p>Политики контроля доступа выражаются в терминах факторов контроля доступа; например, "запрос с факторами i,j,k может выполнить операцию Y с ресурсом Z".  Набор факторов контроля доступа, которые разрешены сервером для использования в таких выражениях, зависит от реализации.</p>

<h3><a name="appendix-A.3">A.3</a>. Аутентификация, удостоверяющие данные, идентификационные сущности</h3>

<p>Удостоверяющие данные аутентификации&thinsp;&mdash;&thinsp;это доказательства, которые одна сторона предоставляет другой, подтверждающие подлинность идентификационной сущности стороны, предоставляющей эти данные (например, пользователя) и пытающейся установить новое состояние авторизации с другой стороной (обычно сервером). Аутентификация&thinsp;&mdash;&thinsp;это процесс генерации, передачи и проверки подлинности этих удостоверяющих данных и, следовательно, подтверждения подлинности представляемой этими данными идентификационной сущности. Аутентификационная идентификационная сущность&thinsp;&mdash;&thinsp;это имя, которое присутствует в удостоверяющих данных.</p>

<p>Существует множество форм удостоверяющих данных аутентификации. Используемая форма зависит от конкретного механизма аутентификации, применяемого в переговорах между сторонами. Примеры форм удостоверяющих данных аутентификации: сертификаты X.509, разрешения (тикеты) Kerberos, простые пары идентификационной сущности и пароля. Имейте ввиду, что механизмы аутентификации могут накладывать ограничения на используемые с ними формы аутентификационных идентификационных сущностей.</p>

<h3><a name="appendix-A.4">A.4</a>. Авторизационная идентификационная сущность</h3>

<p>Авторизационная идентификационная сущность&thinsp;&mdash;&thinsp;это один из типов факторов контроля доступа. Она представляет собой имя пользователя или иного субъекта, запрашивающего те операции, которые будут выполняться. Политики контроля доступа часто выражаются в терминах авторизационных идентификационных сущностей; например, "субъект X может выполнить операцию Y с ресурсом Z".</p>

<p>Авторизационная идентификационная сущность сессии LDAP часто семантически совпадает с представленной клиентом аутентификационной идентификационной сущностью, но они могут различаться. SASL позволяет клиентам указать авторизационную идентификационную сущность отличную от аутентификационной, представленной в удостоверяющих данных клиента. Это позволяет агентам, таким как прокси-серверы, проходить аутентификацию на LDAP-сервере с использованием своих собственных удостоверяющих данных, а затем запрашивать привилегии доступа той идентификационной сущности, для которой они они осуществляют проксирование [<a href="http://tools.ietf.org/html/rfc4422" title="Simple Authentication and Security Layer (SASL)">RFC4422</a>]. Кроме того, форма аутентификационной идентификационной сущности, предоставляемой некоторыми сервисами (например, TLS), может не соответствовать авторизационным идентификационным сущностям, используемым для выражения политики контроля доступа сервера, и потому требует выполнения какого либо специфичного для сервера отображения одной сущности в другую. Метод, по которому сервер составляет авторизационную идентификационную сущность из предоставленных клиентом удостоверяющих данных аутентификации и проверяет правильность такого составления, зависит от реализации.</p>

<h2><a name="appendix-B">Приложение B</a>. Обзор изменений</h2>

<p>Это приложение не является нормативным.</p>

<p>В данном приложении собраны основные изменения, внесённые в <a href="http://tools.ietf.org/html/rfc2251">RFC 2251</a>, <a href="http://tools.ietf.org/html/rfc2829">RFC 2829</a> и <a href="http://tools.ietf.org/html/rfc2830">RFC 2830</a>. Читателям данного документа следует знать, что, кроме описанных ниже конкретных изменений, в текст исходных документов были внесены многочисленные общие редакционные правки, в том числе:</p>
<ul>
<li>Материал, изначально размещённый в разделах <a href="http://tools.ietf.org/html/rfc2251#section-4.2.1">4.2.1</a> и <a href="http://tools.ietf.org/html/rfc2251#section-4.2.2">4.2.2</a> <a href="http://tools.ietf.org/html/rfc2251">RFC 2251</a>, в <a href="http://tools.ietf.org/html/rfc2829">RFC 2829</a> (все разделы, за исключением <a href="http://tools.ietf.org/html/rfc2829#section-2">2</a> и <a href="http://tools.ietf.org/html/rfc2829#section-4">4</a>), а также в <a href="http://tools.ietf.org/html/rfc2830">RFC 2830</a>, был собран в один документ.</li>
<li>Объединённый материал был существенно реорганизован и отредактирован с целью группировки связанных предметов, улучшения структуры документа и уточнения его задач.</li>
<li>Были внесены изменения по тексту для согласования определений уровней протокола LDAP с терминологией безопасности IETF.</li>
<li>Существенные обновления и дополнения были внесены в освещение вопросов безопасности всех документов на основе текущего опыта работы.</li>
</ul>
<h3><a name="appendix-B.1">B.1</a>. Изменения, внесённые в RFC 2251</h3>

<p>В этом разделе собраны основные изменения, внесённые этим документом в разделы <a href="http://tools.ietf.org/html/rfc2251#section-4.2.1">4.2.1</a> и <a href="http://tools.ietf.org/html/rfc2251#section-4.2.2">4.2.2</a> <a href="http://tools.ietf.org/html/rfc2251">RFC 2251</a>. Кроме того, важные изменения, внесённые в <a href="http://tools.ietf.org/html/rfc2251#section-4.2.1">раздел 4.2.1 RFC 2251</a>, представлены в [<a href="rfc4511.html#appendix-C.1.13" title="LDAP: Определение протокола">RFC4511</a>].</p>

<h3><a name="appendix-B.1.1">B.1.1</a>. Раздел 4.2.1 (Последовательность запросов Bind)</h3>
<ul>
<li>Параграф 1: убрано предложение "Если на каком-то этапе клиент желает прервать процесс подсоединения, он может (MAY) выполнить отсоединение unbind, а затем сбросить лежащее в основе соединение". Операция Unbind всё ещё допускает такой режим работы, но явно это не документировано.</li>
<li>Уточнено, что после получения BindRequest PDU сессия переводится в анонимное состояние, а также то, что она переводится в неанонимное состояние только в случае успешного выполнения запроса Bind.</li>
</ul>
<h3><a name="appendix-B.1.2">B.1.2</a>. Раздел 4.2.2 (Аутентификация и другие сервисы обеспечения безопасности)</h3>
<ul>
<li>В <a href="http://tools.ietf.org/html/rfc2251">RFC 2251</a> утверждается, что анонимная аутентификация должна (MUST) быть выполнена с использованием метода простого подсоединения. В этой спецификации определён механизм анонимной аутентификации метода простого подсоединения и от всех реализаций, удовлетворяющих требованию этого документа, требуется его поддержка. Другие механизмы аутентификации, в результате которых устанавливается анонимное состояние аутентификации и авторизации, также могут быть реализованы и использоваться в реализациях, удовлетворяющих требованию этого документа.</li>
</ul>
<h3><a name="appendix-B.2">B.2</a>. Изменения, внесённые в RFC 2829</h3>

<p>В этом разделе собраны основные изменения, внесённые в <a href="http://tools.ietf.org/html/rfc2829">RFC 2829</a>.</p>

<h3><a name="appendix-B.2.1">B.2.1</a>. Раздел 4 (Требуемые механизмы обеспечения безопасности)</h3>
<ul>
<li>Защищённый TLS механизм аутентификации по имени пользователя и паролю (смотрите <a href="#appendix-B.2.5">раздел B.2.5 ниже</a>) заменяет механизм SASL DIGEST-MD5 в качестве обязательного для реализации механизма аутентификации LDAP на основе пароля. Разработчикам рекомендуется продолжать поддерживать механизм SASL DIGEST-MD5 [<a href="#ref-DIGEST-MD5" title="Using Digest Authentication as a SASL Mechanism">DIGEST-MD5</a>].</li>
</ul>
<h3><a name="appendix-B.2.2">B.2.2</a>. Раздел 5.1 (Процедура анонимной аутентификации)</h3>
<ul>
<li>Уточнено, что анонимная аутентификация предполагает предоставление значения имени нулевой длины и значения пароля нулевой длины. Был добавлен механизм аутентификации без проверки подлинности для обработки запросов Bind, включающих значение имени ненулевой длины и значение пароля нулевой длины.</li>
</ul>
<h3><a name="appendix-B.2.3">B.2.3</a>. Раздел 6 (Аутентификация на основе пароля)</h3>
<ul>
<li>Смотрите <a href="#appendix-B.2.1">раздел B.2.1</a>.</li>
</ul>

<h3><a name="appendix-B.2.4">B.2.4</a>. Раздел 6.1 (Аутентификация Digest)</h3>
<ul>
<li>Механизм SASL-DIGEST-MD5 больше не является обязательным для реализации, этот раздел стал историческим и не был включён в данный документ. В <a href="http://tools.ietf.org/html/rfc2829#section-6.1">разделе 6.1 RFC 2829</a> по прежнему документирован механизм аутентификации SASL DIGEST-MD5.</li>
</ul>
<h3><a name="appendix-B.2.5">B.2.5</a>. Раздел 6.2 (Способ аутентификации 'simple' при шифровании TLS)</h3>
<ul>
<li>Механизм аутентификации "simple" переименован в механизм аутентификации по имени пользователя и паролю для лучшего обозначения его сути.</li>

<li>Использование TLS было обобщено для согласования с определениями уровней протокола LDAP. Установление TLS теперь обсуждается как отдельный предмет и обобщено для использования со всеми механизмами аутентификации и другими уровнями обеспечения безопасности.</li>

<li>Удалён вывод, что атрибут userPassword является единственным местом для хранения значений паролей, используемых в аутентификации. Больше не существует никаких неявных требований относительно того, как и где пароли, используемые в аутентификации, хранятся на сервере.</li>
</ul>
<h3><a name="appendix-B.2.6">B.2.6</a>. Раздел 6.3 (Другие способы аутентификации с TLS)</h3>
<ul>
<li>Смотрите <a href="#appendix-B.2.5">раздел B.2.5</a>.</li>
</ul>

<h3><a name="appendix-B.2.7">B.2.7</a>. Раздел 7.1 (Аутентификация, основанная на использовании сертификата, с TLS)</h3>
<ul>
<li>Смотрите <a href="#appendix-B.2.5">раздел B.2.5</a>.</li>
</ul>

<h3><a name="appendix-B.2.8">B.2.8</a>. Раздел 8 (Другие механизмы)</h3>
<ul>
<li>Все механизмы аутентификации SASL явно разрешены в LDAP. Конкретнее, это означает, что механизмы SASL ANONYMOUS и SASL PLAIN больше не исключаются из использования в LDAP.</li>
</ul>
<h3><a name="appendix-B.2.9">B.2.9</a>. Раздел 9 (Авторизационная идентификационная сущность)</h3>
<ul>
<li>Указаны правила соответствия для значений dnAuthzId и uAuthzId. Конкретнее, значение DN в dnAuthzId должно сравниваться с использованием правил соответствия DN, а значение uAuthzId должно (MUST) быть подготовлено с помощью правил SASLprep перед выполнением побайтного сравнения.</li>
<li>Уточнено, что значения uAuthzId не должны рассматриваться как глобально уникальные.</li>
</ul>
<h3><a name="appendix-B.2.10">B.2.10</a>. Раздел 10 (Наборы шифров TLS)</h3>
<ul>
<li>В данную спецификацию больше не включаются рекомендации по наборам шифров TLS. В настоящее время реализации должны поддерживать набор шифров TLS_RSA_WITH_3DES_EDE_CBC_SHA, а также им следует продолжать поддерживать набор шифров TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA.</li>
<li>Уточнено, что анонимная аутентификация предполагает предоставление значения имени нулевой длины и значения пароля нулевой длины. Был добавлен механизм аутентификации без проверки подлинности для обработки запросов Bind, включающих значение имени ненулевой длины и значение пароля нулевой длины.</li>
</ul>

<h3><a name="appendix-B.3">B.3</a>. Изменения, внесённые в RFC 2830</h3>

<p>В этом разделе собраны основные изменения, внесённые в разделы <a href="http://tools.ietf.org/html/rfc2830#section-3">3</a> и <a href="http://tools.ietf.org/html/rfc2830#section-5">5</a> <a href="http://tools.ietf.org/html/rfc2830">RFC 2830</a>. В [<a href="rfc4511.html#appendix-C.2" title="LDAP: Определение протокола">RFC4511</a>] перечислены изменения, внесённые в другие разделы этого RFC.</p>

<h3><a name="appendix-B.3.1">B.3.1</a>. Раздел 3.6 (Проверка идентификационной сущности сервера)</h3>
<ul>
<li>Существенно обновлён алгоритм проверки идентификационной сущности сервера с целью доподлинного установления её полноты и надёжности. Конкретнее, в алгоритме рассмотрено использование всех возможных значений в полях subjectAltName и subjectName, а также указаны правила соответствия для каждого типа значений. Теперь могут быть использованы отображённые (вычисленные) формы идентификационной сущности сервера при условии, что отображение выполнялось защищённым способом.</li>
</ul>
<h3><a name="appendix-B.3.2">B.3.2</a>. Раздел 3.7 (Обновление информации о возможностях сервера)</h3>
<ul>
<li>От клиента больше не требуется всегда обновлять информацию о возможностях сервера после установления уровня TLS. Это не нужно делать в ситуациях, когда данная информация была получена с использованием каких-либо безопасных механизмов.</li>
</ul>
<h3><a name="appendix-B.3.3">B.3.3</a>. Раздел 5 (Влияние TLS на авторизационную идентификационную сущность клиента)</h3>
<ul>
<li>Установление уровня TLS в сессии LDAP теперь может приводить к изменению состояния авторизации этой сессии LDAP.</li>
</ul>
<h3><a name="appendix-B.3.4">B.3.4</a>. Раздел 5.2 (Последствия закрытия соединения TLS)</h3>
<ul>
<li>Закрытие уровня TLS в сессии LDAP изменяет состояния аутентификации и авторизации этой LDAP в соответствии с локальной политикой. Конкретнее, это означает, что от реализаций не требуется изменять состояния аутентификации и авторизации на анонимные после закрытия TLS.</li>
<li>Ссылки, указывающие на <a href="http://tools.ietf.org/html/rfc2401">RFC 2401</a>, заменены на <a href="http://tools.ietf.org/html/rfc4301">RFC 4301</a>.</li>
</ul>

<h2>Адрес автора</h2>
<p>Roger Harrison</p>
<p>Novell, Inc., 1800 S. Novell Place, Provo, Utah 84606, USA</p>
<p>Телефон: +1 801 861 2642</p>
<p>EMail: roger_harrison@novell.com

<h2>Полное заявление авторских прав</h2>

<p>Copyright (C) Internet Society (2006).</p>

<p>На этот документ распространяются права, лицензии и ограничения, содержащиеся в <a target="_blank" href="http://tools.ietf.org/html/bcp78">BCP 78</a>, и, за исключением случаев, изложенных в нем, авторы сохраняют все свои права.</p>

<p>Этот документ и содержащаяся в нём информация распространяются "КАК ЕСТЬ" и АВТОР ДОКУМЕНТА, ОРГАНИЗАЦИЯ, КОТОРУЮ ОН/ОНА ПРЕДСТАВЛЯЕТ, ИЛИ КОТОРОЙ ОН/ОНА СПОНСИРУЕТСЯ (ЕСЛИ ТАКОВЫЕ ИМЕЮТСЯ), INTERNET SOCIETY И INTERNET ENGINEERING TASK FORCE ОТКАЗЫВАЮТСЯ ОТ ВСЕХ ГАРАНТИЙ, ЯВНЫХ ИЛИ ПОДРАЗУМЕВАЕМЫХ, ВКЛЮЧАЯ, ПОМИМО ПРОЧЕГО, ЛЮБЫЕ ГАРАНТИИ ТОГО, ЧТО ИСПОЛЬЗОВАНИЕ ПРИВЕДЁННОЙ ЗДЕСЬ ИНФОРМАЦИИ НЕ НАРУШАЕТ КАКИХ-ЛИБО ПРАВ ИЛИ ЛЮБЫЕ ПОДРАЗУМЕВАЕМЫЕ ГАРАНТИИ ПРИГОДНОСТИ ДЛЯ КОНКРЕТНЫХ ЦЕЛЕЙ.</p>

<h2>Интеллектуальная собственность</h2>

<p>IETF не занимает никакой позиции относительно действительности или области действия каких-либо прав на интеллектуальную собственность или других прав, которые могут заявляться как относящиеся к реализации или использованию технологий, описанных в данном документе, либо в подтверждении которых могут или не могут быть доступны какие-либо лицензии; кроме того, IETF не заявляет о том, что она будет предпринимать какие-либо независимые усилия по выявлению подобных прав. Информацию по процедурам в отношении прав в документах RFC можно найти в <a target="_blank" href="http://tools.ietf.org/html/bcp78">BCP 78</a> и <a target="_blank" href="http://tools.ietf.org/html/bcp79">BCP 79</a>.</p>

<p>Копии поданных в секретариат IETF заявлений о правах на интеллектуальную собственность (Intellectual Property Rights, IPR), а также какие-либо документы, подтверждающие лицензию и предназначенные для предоставления доступа к ним, либо результаты попыток получения генеральных лицензий или разрешений на пользование подобными правами собственности могут быть получены теми, кто занимается реализацией, или пользователями данной спецификации из он-лайн репозитория IPR IETF по адресу <a target="_blank" href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.</p>

<p>IETF просит всех заинтересованных лиц довести до её сведения любые авторские права, патенты или патентные заявки, либо другие права собственности, которые могут касаться технологий данного стандарта и могут потребоваться для его реализации. Пожалуйста, направляйте информацию в IETF по адресу ietf-ipr@ietf.org.</p>

<h2>Признание заслуг</h2>

<p>Финансирование функций RFC Editor обеспечивается IETF Administrative Support Activity (IASA).</p>

<div style="font-size:90%;font-style:italic;margin:30px">Перевод выполнен участниками проекта <a href="http://pro-ldap.ru">Pro-LDAP.ru</a>. Предложения по улучшению перевода и сообщения об ошибках принимаются на <a href="http://pro-ldap.ru/forum/index.php?topic=40.0">форуме проекта</a>.</div>
</body></html>
