<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="Ресурсы проекта Pro-LDAP.ru. RFC по службам каталогов и LDAP." />
<meta name="keywords" content="Pro-LDAP.ru,LDAP,OpenLDAP,slapd,по-русски,на русском,перевод,документация,RFC" />
<link rel="stylesheet" href="/pro-ldap.css" type="text/css">
<title>RFC 4518</title>
<script src="/pro-ldap.js"></script>
</head>
<div style="font-size:90%;font-style:italic;margin:30px">Перевод выполнен участниками проекта <a href="http://pro-ldap.ru">Pro-LDAP.ru</a>. Предложения по улучшению перевода и сообщения об ошибках принимаются на <a href="http://pro-ldap.ru/forum/index.php?topic=40.0">форуме проекта</a>.</div>

<pre>Network Working Group
<strong>Request for Comments: 4518</strong>
Категория: Standards Track
K. Zeilenga, OpenLDAP Foundation
Июнь 2006 года
</pre>

<h1>Lightweight Directory Access Protocol (LDAP): Подготовка интернационализированных строк</h1>

<h3>Статус документа</h3>

<p>Этот документ определяет проект стандарта протокола Интернет для сообщества Интернет, а также приглашает к обсуждению и подаче предложений по его усовершенствованию. Пожалуйста, сверяйтесь с текущей редакцией "Официальных стандартов протоколов Интернет" (STD 1), чтобы узнать состояние стандартизации и статус этого протокола. Ограничений на распространение данного документа не накладывается.</p>

<h3>Уведомление об авторских правах</h3>

<p>Copyright (C) Internet Society (2006).</p>

<h3>Тезисы</h3>

<p>В предыдущей технической спецификации протокола Lightweight Directory Access Protocol (LDAP) не давалось точного определения тому, как должно выполняться сравнение символьных строк. Это привело к ряду проблем в областях удобства и простоты использования, а также совместимости. В этом документе определяются алгоритмы подготовки строк для определённых к использованию в LDAP правил соответствия, оперирующих с символьными строками.</p>

<h2><a name="section-1">1</a>. Введение</h2>

<h3><a name="section-1.1">1.1</a>. Предпосылки</h3>

<p>Правило соответствия [<a href="rfc4517.html" title="LDAP: Синтаксисы и правила соответствия">RFC4517</a>] протокола LDAP [<a href="http://tools.ietf.org/html/rfc4510" title="LDAP: Technical Specification Road Map">RFC4510</a>] задаёт алгоритм для определения того, соответствует ли представленное значение значению атрибута согласно критериям, определённым для данного правила. Утверждение может быть оценено как True, False или Undefined.</p>

<blockquote>
<p>True&thinsp;&mdash;&thinsp;в атрибуте содержится соответствующее значение,</p>
<p>False&thinsp;&mdash;&thinsp;в атрибуте не содержится соответствующее значение,</p>
<p>Undefined&thinsp;&mdash;&thinsp;невозможно определить, содержится ли в атрибуте соответствующее значение.</p>
</blockquote>

<p>Например, правило соответствия caseIgnoreMatch может быть использовано для определения того, содержит ли атрибут commonName конкретное значение, без учёта регистра символов и незначимых пробелов.</p>

<h3><a name="section-1.2">1.2</a>. Строковые правила соответствия X.500</h3>

<p>Стандарт X.520 "The Directory: Selected attribute types" [<a href="#ref-X.520" title="The Directory: Selected Attribute Types">X.520</a>] определяет (помимо прочего) синтаксисы значений и правила соответствия для сравнения обычно используемых в каталоге <a href="#ref-X.500" title="The Directory: Overview of concepts, models and services,">X.500</a> значений. Эти спецификации не подходят для строк, состоящих из символов Unicode [<a href="#ref-Unicode" title="The Unicode Standard, Version 3.2.0">Unicode</a>].</p>

<p>К примеру, правило соответствия caseIgnoreMatch в <a href="#ref-X.520" title="The Directory: Selected Attribute Types">X.520</a> определяется просто как сравнение без учёта регистра символов с игнорированием незначимых пробелов. Для значений printableString, где только один пробельный символ и отображение регистра символов является биективным, такого определения достаточно. Однако, для Unicode-строковых типов, таких как universalString, оно недостаточно. Например, реализации сравнения без учёта регистра символов, преобразующие символы в нижнем регистре в верхний, будут выдавать результаты, отличающиеся от результатов реализаций сравнения, преобразующих верхний регистр символов в нижний. Или же, в одной реализации пробелы могут рассматриваться как только символ SPACE (U+0020), во второй&thinsp;&mdash;&thinsp;как любой символ со свойством space separator (Zs), а в третьей&thinsp;&mdash;&thinsp;как любой символ с категорией whitespace (WS).</p>

<p>Отсутствие точной спецификации соответствия символьных строк привело к значительным проблемам с совместимостью. Если такие сравнения выполняются при проверке цепочки сертификатов, это может привести к уязвимости в системе безопасности. Для решения этих проблем в данном документе определяются точные алгоритмы подготовки символьных строк для сравнения.</p>

<h3><a name="section-1.3">1.3</a>. Взаимосвязь с "stringprep"</h3>

<p>Описанные в этом документе алгоритмы подготовки символьных строк основаны на подходе "stringprep" [<a href="http://tools.ietf.org/html/rfc3454" title="Preparation of Internationalized Strings">RFC3454</a>]. В "stringprep" предоставляемые и хранимые значения сначала подготавливаются для сравнения, поэтому посимвольное сравнение даёт "правильный" результат.</p>

<p>Описанный в данном документе подход является усовершенствованием подхода "stringprep" [<a href="http://tools.ietf.org/html/rfc3454" title="Preparation of Internationalized Strings">RFC3454</a>]. Каждый алгоритм включает в себя два дополнительных шага подготовки:</p>

<ol type="a">
<li>Перед применением изложенных в "stringprep" шагов подготовки строки Unicode, строка транскодируется в Unicode.</p>
<li>После применения изложенных в "stringprep" шагов подготовки строки Unicode, строка модифицируется путём обработки символов, малозначительных для данного правила соответствия, способом, подходящим для этого правила соответствия.</li>
</ol>

<p>Таким образом, подготовка строки для сравнения [<a href="#ref-X.501" title="The Directory: Models">X.501</a>] в <a href="#ref-X.500" title="The Directory: Overview of concepts, models and services">X.500</a> включает в себя следующие шаги:</p>

<ol>
<li><a href="#section-2.1">Транскодирование</a> (Transcode)</li>
<li><a href="#section-2.2">Отображение</a> (Map)</li>
<li><a href="#section-2.3">Нормализация</a> (Normalize)</li>
<li><a href="#section-2.4">Запрет</a> (Prohibit)</li>
<li><a href="#section-2.5">Проверка двунаправленности</a> (Check Bidi (Bidirectional))</li>
<li><a href="#section-2.6">Обработка малозначительных символов</a> (Insignificant Character Handling)</li>
</ol>

<p>Данные шаги описаны в <a href="#section-2">разделе 2</a>.</p>

<p>Обратите внимание, что, несмотря на то, что различные таблицы символов Unicode, которые включены в данную спецификацию, или на которые она ссылается, получены из данных Unicode [<a href="#ref-Unicode" title="The Unicode Standard, Version 3.2.0">Unicode</a>], эти таблицы должны считаться окончательными при реализации данной спецификации.</p>

<h3><a name="section-1.4">1.4</a>. Взаимосвязь с технической спецификацией LDAP</h3>

<p>Данный документ является неотъемлемой частью технической спецификации LDAP [<a href="http://tools.ietf.org/html/rfc4510" title="LDAP: Technical Specification Road Map">RFC4510</a>], полностью отменяющей ранее определённую техническую спецификацию LDAP [<a href="http://tools.ietf.org/html/rfc3377" title="Lightweight Directory Access Protocol (v3): Technical Specification">RFC3377</a>].</p>

<p>В данном документе определяются новые алгоритмы подготовки интернационализированных символьных строк LDAP, используемые в [<a href="rfc4517.html" title="LDAP: Синтаксисы и правила соответствия">RFC4517</a>] и, возможно, в других технических спецификациях, определяющих синтаксисы и/или правила соответствия LDAP.</p>

<h3><a name="section-1.5">1.5</a>. Взаимосвязь с X.500</h3>

<p>LDAP [<a href="http://tools.ietf.org/html/rfc4510" title="LDAP: Technical Specification Road Map">RFC4510</a>] определён в терминах X.500 как механизм доступа к каталогам X.500. Поэтому, крайне желательно соблюдать принцип взаимности преобразований между синтаксисами и семантиками LDAP и X.500. Описанные в этом документе алгоритмы подготовки символьных строк основанны на правилах "Internationalized String Matching Rules for X.500" [<a href="#ref-XMATCH" title="Internationalized String Matching Rules for X.500">XMATCH</a>], предложенных ITU/ISO Joint Study Group 2.</p>

<h3><a name="section-1.6">1.6</a>. Соглашения и термины</h3>

<p>Ключевые слова "MUST" (необходимо), "MUST NOT" (недопустимо), "REQUIRED" (требуется), "SHALL" (нужно), "SHALL NOT" (не нужно), "SHOULD" (следует), "SHOULD NOT" (не следует), "RECOMMENDED" (рекомендуется), "MAY" (возможно) и "OPTIONAL" (необязательно) в данном документе должны интерпретироваться так, как описано в <a href="http://rfc2.ru/2119.rfc">BCP 14</a> [<a href="http://rfc2.ru/2119.rfc" title="Ключевые слова для обозначения уровня требований в RFC">RFC2119</a>].</p>

<p>Для именования символов в этом документе используются обозначения кодов и имён из стандарта Unicode [<a href="#ref-Unicode" title="The Unicode Standard, Version 3.2.0">Unicode</a>]. Например, буква "a" может быть представлена как &lt;U+0061&gt;, либо как &lt;LATIN SMALL LETTER A&gt;. В списках отображений и запрещённых символов для упрощения чтения начальное "U+" опускается. Комментарии по поводу диапазонов символов показаны в квадратных скобках (например, "[CONTROL CHARACTERS]"), они не являются частью стандарта Unicode.</p>

<p>Примечание: глоссарий используемых в Unicode терминов можно найти в источнике [<a href="#ref-Glossary" title="Unicode Glossary">Glossary</a>]. Информацию о модели кодирования символов Unicode можно найти в источнике [<a href="#ref-CharModel" title="Unicode Technical Report #17, Character Encoding Model">CharModel</a>].</p>

<p>Используемый в этой спецификации термин "метки комбинирования", указывает на любой код Unicode [<a href="#ref-Unicode" title="The Unicode Standard, Version 3.2.0">Unicode</a>], у которого имеется свойство метки (Mn, Mc, Me). В <a href="#appendix-A">приложении A</a> приведён исчерпывающий список меток комбинирования.</p>

<h2><a name="section-2">2</a>. Подготовка строки</h2>

<p>Для подготовки к сравнению с использованием правила соответствия, применяемого к символьным строкам, к каждому предоставляемому значению и значению атрибута нужно (SHALL) применить следующий процесс, состоящий из шести шагов:</p>

<ol>
<li><a href="#section-2.1">Транскодирование</a> (Transcode)</li>
<li><a href="#section-2.2">Отображение</a> (Map)</li>
<li><a href="#section-2.3">Нормализация</a> (Normalize)</li>
<li><a href="#section-2.4">Запрет</a> (Prohibit)</li>
<li><a href="#section-2.5">Проверка двунаправленности</a> (Check Bidi)</li>
<li><a href="#section-2.6">Обработка малозначительных символов</a> (Insignificant Character Handling)</li>
</ol>

<p>Неудачное завершение любого из этих шагов приводит к тому, что предоставленное утверждение оценивается как Undefined.</p>

<p>Множество символов, с которыми работает этот процесс: Unicode 3.2 [<a href="#ref-Unicode" title="The Unicode Standard, Version 3.2.0">Unicode</a>].</p>

<p>Имейте ввиду, что спецификация данного процесса из шести шагов предназначается для описания ожидаемого поведения при выполнении сравнения. Разработчики вольны использовать альтернативные процессы, если их поведение при выполнении оценки по правилу соответствия согласуется с поведением, описанным в данной спецификации.</p>

<h3><a name="section-2.1">2.1</a>. Транскодирование</h3>

<p>Каждое строковое значение в отличном от Unicode формате транскодируется в Unicode.</p>

<p>Значения PrintableString [<a href="#ref-X.680" title="Abstract Syntax Notation One (ASN.1) - Specification of Basic Notation">X.680</a>] транскодируются непосредственно в Unicode.</p>

<p>Значения UniversalString, UTF8String и bmpString [<a href="#ref-X.680" title="Abstract Syntax Notation One (ASN.1) - Specification of Basic Notation">X.680</a>] транскодировать не требуется, поскольку они представляют собой основанные на Unicode строки (в случае bmpString&thinsp;&mdash;&thinsp;основанные на подмножестве Unicode).</p>

<p>Значения TeletexString [<a href="#ref-X.680" title="Abstract Syntax Notation One (ASN.1) - Specification of Basic Notation">X.680</a>] транскодируются в Unicode. Поскольку стандарта для отображения значений TeletexString в Unicode нет, порядок такого отображения оставляется на усмотрение разработчиков.</p>

<p>По этой и другим причинам использовать TeletexString не рекомендуется (NOT RECOMMENDED).</p>

<p>На выходе этого шага получается транскодированная строка.</p>

<h3><a name="section-2.2">2.2</a>. Отображение</h3>

<p>Коды SOFT HYPHEN (U+00AD) и MONGOLIAN TODO SOFT HYPHEN (U+1806) отображаются в ничто. Коды COMBINING GRAPHEME JOINER (U+034F) и VARIATION SELECTORs (U+180B-180D, FE00-FE0F) также отображаются в ничто. OBJECT REPLACEMENT CHARACTER (U+FFFC) отображается в ничто.</p>

<p>Коды CHARACTER TABULATION (U+0009), LINE FEED (LF) (U+000A), LINE TABULATION (U+000B), FORM FEED (FF) (U+000C), CARRIAGE RETURN (CR) (U+000D) и NEXT LINE (NEL) (U+0085) отображаются в SPACE (U+0020).</p>

<p>Все остальные контрольные коды (например, Cc) или коды с контрольной функцией (например, Cf) отображаются в ничто. Полный список таких кодов: U+0000-0008, 000E-001F, 007F-0084, 0086-009F, 06DD, 070F, 180E, 200C-200F, 202A-202E, 2060-2063, 206A-206F, FEFF, FFF9-FFFB, 1D173-1D17A, E0001, E0020-E007F.</p>

<p>ZERO WIDTH SPACE (U+200B) отображается в ничто. Все остальные коды со свойством разделителя (пробела, строки или параграфа) (например, Zs, Zl или Zp) отображаются в SPACE (U+0020). Полный список таких кодов: U+0020, 00A0, 1680, 2000-200A, 2028-2029, 202F, 205F, 3000.</p>

<p>Для правил соответствия с игнорированием регистра символов, правил соответствия для числовых строк и строк с сохранённым префиксом, унификация регистра символов выполняется согласно <a href="http://tools.ietf.org/html/rfc3454#appendix-B.2" title="Preparation of Internationalized Strings">пункту B.2 RFC3454</a>.</p>

<p>На выходе этого шага получается отображённая строка.</p>

<h3><a name="section-2.3">2.3</a>. Нормализация</h3>

<p>Входная строка должна быть нормализована в Unicode Form KC (форма, подготовленная с учётом совместимости), как описано в [<a href="#ref-UAX15" title="Unicode Standard Annex #15: Unicode Normalization Forms, Version 3.2.0">UAX15</a>]. На выходе этого шага получается нормализованная строка.</p>

<h3><a name="section-2.4">2.4</a>. Запрет</h3>

<p>Все неназначенные коды запрещены. Неназначенные коды перечислены в <a href="http://tools.ietf.org/html/rfc3454#appendix-A.1" title="Preparation of Internationalized Strings">таблице A.1 RFC3454</a>.</p>

<p>Символы, которые (согласно <a href="http://tools.ietf.org/html/rfc3454#section-5.8">разделу 5.8 RFC3454</a>) изменяют параметры экрана, либо являются устаревшими, запрещены. Такие символы перечислены в <a href="http://tools.ietf.org/html/rfc3454#appendix-C.8" title="Preparation of Internationalized Strings">таблице C.8 RFC3454</a>.</p>

<p>Коды, выделенные для частного использования, запрещены. Такие символы перечислены в <a href="http://tools.ietf.org/html/rfc3454#appendix-C.3" title="Preparation of Internationalized Strings">таблице C.3 RFC3454</a>.</p>

<p>Все несимвольные коды запрещены. Такие коды перечислены в <a href="http://tools.ietf.org/html/rfc3454#appendix-C.4" title="Preparation of Internationalized Strings">таблице C.4 RFC3454</a>.</p>

<p>Суррогатные коды запрещены. Такие символы перечислены в <a href="http://tools.ietf.org/html/rfc3454#appendix-C.5" title="Preparation of Internationalized Strings">таблице C.5 RFC3454</a>.</p>

<p>Код REPLACEMENT CHARACTER (U+FFFD) запрещён.</p>

<p>Данный шаг завершается неудачей, если во входной строке содержится запрещённый код. В противном случае, на выход этого шага передаётся входная строка.</p>

<h3><a name="section-2.5">2.5</a>. Проверка двунаправленности</h3>

<p>Двунаправленные символы игнорируются.</p>

<h3><a name="section-2.6">2.6</a>. Обработка малозначительных символов</h3>

<p>На этом шаге строка модифицируется так, чтобы обеспечить надлежащую обработку символов, незначительных для конкретного правила соответствия. Такая модификация отличается для разных правил соответствия.</p>

<p>К правилам соответствия с учётом и без учёта регистра символов применяется модификация, описанная в <a href="#section-2.6.1">разделе 2.6.1</a>.</p>
<p>К правилам соответствия, оперирующим со строками numericString, применяется модификация, описанная в <a href="#section-2.6.2">разделе 2.6.2</a>.</p>
<p>К правилам соответствия, оперирующим со строками telephoneNumber, применяется модификация, описанная в <a href="#section-2.6.3">разделе 2.6.3</a>.</p>

<h4><a name="section-2.6.1">2.6.1</a>. Обработка малозначительных пробельных символов</h4>

<p>В этом разделе пробел определяется как код SPACE (U+0020), за которым не следуют никакие <a href="#section-1.6">метки комбинирования</a>.</p>

<blockquote>
<p>ПРИМЕЧАНИЕ: Выполнение предыдущих шагов даёт гарантию того, что входная строка не может содержать никаких кодов из класса разделителей, кроме SPACE (U+0020).</p>
</blockquote>

<p>Для входных строк, представляющих собой значение атрибута или значение утверждения, не являющееся подстрокой: если во входной строке не содержится непробельных символов, то выходная строка будет представлять собой ровно два символа SPACE. В противном случае (во входной строке присутствует хотя бы один непробельный символ), эта строка модифицируется таким образом, что она будет начинаться ровно с одного символа SPACE, заканчиваться ровно одним символом SPACE, и любые внутренние (не пустые) последовательности пробельных символов будут заменены на ровно два символа SPACE. Например, входная строка</p>

<pre class="list">
       "foo&lt;SPACE&gt;bar&lt;SPACE&gt;&lt;SPACE&gt;"
</pre>
<p>в результате преобразования даст на выходе</p>
<pre class="list">
       "&lt;SPACE&gt;foo&lt;SPACE&gt;&lt;SPACE&gt;bar&lt;SPACE&gt;"
</pre>

<p>Для входных строк, представляющих собой значение утверждения, являющееся подстрокой: если в подготавливаемой строке не содержится непробельных символов, то выходная строка будет представлять собой ровно один символ SPACE. В противном случае выполняются следующие шаги:</p>

<ul>
<li>Любая внутренняя (не пустая) последовательность пробельных символов заменяется ровно двумя символами SPACE;</li>
<li>Если входная строка представляет собой initial-подстроку, она модифицируется таким образом, что она будет начинаться ровно с одного символа SPACE;</li>
<li>Если входная строка представляет собой initial-подстроку или any-подстроку, которая заканчивается на один или более пробельный символ, она модифицируется таким образом, что она будет заканчиваться ровно на один символ SPACE;</li>
<li>Если входная строка представляет собой any-подстроку или final-подстроку, которая начинается на один или более пробельный символ, она модифицируется таким образом, что она будет начинаться ровно с одного символа SPACE; и</li>
<li>Если входная строка представляет собой final-подстроку, она модифицируется таким образом, что она будет заканчиваться ровно на один символ SPACE.</li>
</ul>

<p>Например, для входной строки
<pre class="list">
       "foo&lt;SPACE&gt;bar&lt;SPACE&gt;&lt;SPACE&gt;"
</pre>
<p>если она представляет собой initial-подстроку, выходная строка будет:</p>
<pre class="list">
       "&lt;SPACE&gt;foo&lt;SPACE&gt;&lt;SPACE&gt;bar&lt;SPACE&gt;"
</pre>
<p>Если же она представляет собой any-подстроку или final-подстроку, та же входная строка даст на выходе:</p>
<pre class="list">
       "foo&lt;SPACE&gt;&lt;SPACE&gt;bar&lt;SPACE&gt;"
</pre>

<p>Обоснование такого поведения обсуждается в <a href="#appendix-B">приложении B</a>.</p>

<h4><a name="section-2.6.2">2.6.2</a>. Обработка малозначительных символов для строк numericString</h4>

<p>В этом разделе пробел определяется как код SPACE (U+0020), за которым не следуют никакие <a href="#section-1.6">метки комбинирования</a>.</p>

<p>Все пробелы рассматриваются как незначительные и должны быть удалены.</p>

<p>Например, при удалении пробелов из такой Form KC-строки:</p>
<pre class="list">
       "&lt;SPACE&gt;&lt;SPACE&gt;123&lt;SPACE&gt;&lt;SPACE&gt;456&lt;SPACE&gt;&lt;SPACE&gt;"
</pre>
<p>получится выходная строка:</p>
<pre class="list">
       "123456"
</pre>
<p>А при удалении пробелов из такой Form KC-строки:</p>
<pre class="list">
       "&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;"
</pre>
<p>получится выходная строка:</p>
<pre class="list">
       ""
</pre>
<p>(то есть, пустая строка).</p>

<h4><a name="section-2.6.3">2.6.3</a>. Обработка малозначительных символов для строк telephoneNumber</h4>

<p>В этом разделе дефис определяется как символ с кодом HYPHEN-MINUS (U+002D), ARMENIAN HYPHEN (U+058A), HYPHEN (U+2010), NON-BREAKING HYPHEN (U+2011), MINUS SIGN (U+2212), SMALL HYPHEN-MINUS (U+FE63) или FULLWIDTH HYPHEN-MINUS (U+FF0D), за которым не следуют никакие <a href="#section-1.6">метки комбинирования</a>, пробел определяется как код SPACE (U+0020), за которым не следуют никакие <a href="#section-1.6">метки комбинирования</a>.</p>

<p>Все дефисы и пробелы рассматриваются как незначительные и должны быть удалены.</p>

<p>Например, при удалении дефисов и пробелов из такой Form KC-строки::</p>
<pre class="list">
       "&lt;SPACE&gt;&lt;HYPHEN&gt;123&lt;SPACE&gt;&lt;SPACE&gt;456&lt;SPACE&gt;&lt;HYPHEN&gt;"
</pre>
<p>получится выходная строка:</p>
<pre class="list">
       "123456"
</pre>
<p>А при удалении дефисов и пробелов из такой Form KC-строки:</p>
<pre class="list">
       "&lt;HYPHEN&gt;&lt;HYPHEN&gt;&lt;HYPHEN&gt;"
</pre>
<p>получится выходная строка (пустая):</p>
<pre class="list">
       ""
</pre>

<h2><a name="section-3">3</a>. О безопасности</h2>

<p>Соображения безопасности, приведённые в "Preparation of Internationalized Strings ("stringprep")" [<a href="http://tools.ietf.org/html/rfc3454" title="Preparation of Internationalized Strings">RFC3454</a>], в целом относятся и к описанным здесь алгоритмам.</p>

<h2><a name="section-4">4</a>. Благодарности</h2>

<p>Используемый в данном документе подход основан на принципах построения и алгоритмах, описанных в "Preparation of Internationalized Strings ("stringprep")" [<a href="http://tools.ietf.org/html/rfc3454" title="Preparation of Internationalized Strings">RFC3454</a>], авторы Paul Hoffman и Marc Blanchet. Некоторые дополнительные указания были взяты из технических стандартов, технических отчётов и замечаний по Unicode.</p>

<p>Данный документ&thinsp;&mdash;&thinsp;продукт рабочей группы IETF LDAP Revision (LDAPBIS).</p>

<h2><a name="section-5">5</a>. Документы</h2>

<h3><a name="section-5.1">5.1</a>. Нормативные документы</h3>

<p>[<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>] Bradner, S., "Ключевые слова для обозначения уровня требований в RFC", <a href="http://rfc2.ru/2119.rfc">BCP 14</a>, <a href="http://rfc2.ru/2119.rfc">RFC 2119</a>, март 1997 г.</p>

<p>[<a name="ref-RFC3454" id="ref-RFC3454">RFC3454</a>] Hoffman, P. и M. Blanchet, "Preparation of Internationalized Strings ("stringprep")", <a href="http://tools.ietf.org/html/rfc3454">RFC 3454</a>, декабрь 2002 г.</p>

<p>[<a name="ref-RFC4510" id="ref-RFC4510">RFC4510</a>] Под редакцией Zeilenga, K., "Lightweight Directory Access Protocol (LDAP): Technical Specification Road Map", <a href="http://tools.ietf.org/html/rfc4510">RFC4510</a>, июнь 2006 г.</p>

<p>[<a name="ref-RFC4517" id="ref-RFC4517">RFC4517</a>] Под редакцией Legg, S., "Lightweight Directory Access Protocol (LDAP): Синтаксисы и правила соответствия", <a href="rfc4517.html">RFC 4517</a>, июнь 2006 г.</p>

<p>[<a name="ref-Unicode" id="ref-Unicode">Unicode</a>] The Unicode Consortium, "The Unicode Standard, Version 3.2.0" определён в "The Unicode Standard, Version 3.0" (Reading, MA, Addison-Wesley, 2000.  ISBN 0-201-61633-5), с изменениями, внесенными "Unicode Standard Annex #27: Unicode 3.1" (<a href="http://www.unicode.org/reports/tr27/">http://www.unicode.org/reports/tr27/</a>) и "Unicode Standard Annex #28: Unicode 3.2" (<a href="http://www.unicode.org/reports/tr28/">http://www.unicode.org/reports/tr28/</a>).</p>

<p>[<a name="ref-UAX15" id="ref-UAX15">UAX15</a>] Davis, M. и M. Duerst, "Unicode Standard Annex #15: Unicode Normalization Forms, Version 3.2.0". &lt;<a href="http://www.unicode.org/unicode/reports/tr15/tr15-22.html">http://www.unicode.org/unicode/reports/tr15/tr15-22.html</a>&gt;, март 2002 г.</p>

<p>[<a name="ref-X.680" id="ref-X.680">X.680</a>] International Telecommunication Union - Telecommunication Standardization Sector, "Abstract Syntax Notation One (ASN.1) - Specification of Basic Notation", X.680(2002) (also ISO/IEC 8824-1:2002).</p>

<h3><a name="section-5.2">5.2</a>. Информативные документы</h3>

<p>[<a name="ref-X.500" id="ref-X.500">X.500</a>] International Telecommunication Union - Telecommunication Standardization Sector, "The Directory: Overview of concepts, models and services," X.500(1993) (also ISO/IEC 9594-1:1994).</p>

<p>[<a name="ref-X.501" id="ref-X.501">X.501</a>] International Telecommunication Union - Telecommunication Standardization Sector, "The Directory: Models," X.501(1993) (also ISO/IEC 9594-2:1994).</p>

<p>[<a name="ref-X.520" id="ref-X.520">X.520</a>] International Telecommunication Union - Telecommunication Standardization Sector, "The Directory: Selected Attribute Types", X.520(1993) (also ISO/IEC 9594-6:1994).</p>

<p>[<a name="ref-Glossary" id="ref-Glossary">Glossary</a>] The Unicode Consortium, "Unicode Glossary", &lt;<a href="http://www.unicode.org/glossary/">http://www.unicode.org/glossary/</a>&gt;.</p>

<p>[<a name="ref-CharModel" id="ref-CharModel">CharModel</a>] Whistler, K. and M. Davis, "Unicode Technical Report #17, Character Encoding Model", UTR17, &lt;<a href="http://www.unicode.org/unicode/reports/tr17/">http://www.unicode.org/unicode/reports/tr17/</a>&gt;, август 2000 г.</p>

<p>[<a name="ref-RFC3377" id="ref-RFC3377">RFC3377</a>] Hodges, J. and R. Morgan, "Lightweight Directory Access Protocol (v3): Technical Specification", <a href="http://tools.ietf.org/html/rfc3377">RFC 3377</a>, сентябрь 2002 г.</p>

<p>[<a name="ref-RFC4515" id="ref-RFC4515">RFC4515</a>] Smith, M., Ed. and T. Howes, "Lightweight Directory Access Protocol (LDAP): String Representation of Search Filters", <a href="http://tools.ietf.org/html/rfc4515">RFC 4515</a>, июнь 2006 г.</p>

<p>[<a name="ref-XMATCH" id="ref-XMATCH">XMATCH</a>] Zeilenga, K., "Internationalized String Matching Rules for X.500", в разработке.</p>

<h2><a name="appendix-A">Приложение A</a>. Метки комбинирования</h2>

<p>Это приложение является нормативным.</p>

<p>Следующая таблица была получена из файлов данных Unicode [<a href="#ref-Unicode" title="The Unicode Standard, Version 3.2.0">Unicode</a>]; в ней перечислены все коды со свойствами Mn, Mc или Me. При реализации данной спецификации эта таблица должна рассматриваться как исчерпывающая.</p>

<pre class="list">
         0300-034F 0360-036F 0483-0486 0488-0489 0591-05A1
         05A3-05B9 05BB-05BC 05BF 05C1-05C2 05C4 064B-0655 0670
         06D6-06DC 06DE-06E4 06E7-06E8 06EA-06ED 0711 0730-074A
         07A6-07B0 0901-0903 093C 093E-094F 0951-0954 0962-0963
         0981-0983 09BC 09BE-09C4 09C7-09C8 09CB-09CD 09D7
         09E2-09E3 0A02 0A3C 0A3E-0A42 0A47-0A48 0A4B-0A4D
         0A70-0A71 0A81-0A83 0ABC 0ABE-0AC5 0AC7-0AC9 0ACB-0ACD
         0B01-0B03 0B3C 0B3E-0B43 0B47-0B48 0B4B-0B4D 0B56-0B57
         0B82 0BBE-0BC2 0BC6-0BC8 0BCA-0BCD 0BD7 0C01-0C03
         0C3E-0C44 0C46-0C48 0C4A-0C4D 0C55-0C56 0C82-0C83
         0CBE-0CC4 0CC6-0CC8 0CCA-0CCD 0CD5-0CD6 0D02-0D03
         0D3E-0D43 0D46-0D48 0D4A-0D4D 0D57 0D82-0D83 0DCA
         0DCF-0DD4 0DD6 0DD8-0DDF 0DF2-0DF3 0E31 0E34-0E3A
         0E47-0E4E 0EB1 0EB4-0EB9 0EBB-0EBC 0EC8-0ECD 0F18-0F19
         0F35 0F37 0F39 0F3E-0F3F 0F71-0F84 0F86-0F87 0F90-0F97
         0F99-0FBC 0FC6 102C-1032 1036-1039 1056-1059 1712-1714
         1732-1734 1752-1753 1772-1773 17B4-17D3 180B-180D 18A9
         20D0-20EA 302A-302F 3099-309A FB1E FE00-FE0F FE20-FE23
         1D165-1D169 1D16D-1D172 1D17B-1D182 1D185-1D18B
         1D1AA-1D1AD
</pre>

<h2><a name="appendix-B">Приложение B</a>. Соответствие подстрок</h2>

<p>Это приложение не является нормативным.</p>

<p>При отсутствии необходимости определения соответствия подстрок, обработка малозначительных пробельных символов для выполнения сравнения с учётом и без учёта регистра символов может быть упрощена. В частности, такая обработка может заключаться в выдвижении требования, чтобы все последовательности из одного или более пробельных символов были заменены одним пробелом и, если строка содержит непробельные символы, чтобы все начальные и конечные пробелы были удалены.</p>

<p>Если необходимость определения соответствия подстрок есть, то такая упрощённая обработка пробельных символов приведет к непредсказуемому и нежелательному поведению при выполнении сравнения. Например:</p>

<ol>
<li>(CN=foo\20*\20bar) будет соответствовать значению CN "foobar";</li>
<li>(CN=*\20foobar\20*) будет соответствовать "foobar", а (CN=*\20*foobar*\20*)&thinsp;&mdash;&thinsp;не будет соответствовать "foobar".</li>
</ol>

<p>Примечание для читателей, не знакомых с порядком определения соответствия с подстроками в LDAP: утверждение в LDAP-фильтре [<a href="http://tools.ietf.org/html/rfc4515" title="LDAP: String Representation of Search Filters">RFC4515</a>] (CN=A*B*C) говорит: "найти совпадение с любым значением (атрибута CN), которое начинается на A, содержит B после A, и заканчивается на C, где C также должно быть после B."</p>

<p>Первый пример показывает, что такая упрощенная обработка пробелов приведёт к тому, что начальные и конечные пробелы в подстроках строки значения утверждения будут рассматриваться как незначительные. Однако незначительными являются только начальные и конечные пробелы (а также несколько пробелов, следующих друг за другом) строки в целом.</p>

<p>Второй пример показывает, что такая упрощенная обработка пробелов приведёт к сбоям при разбиении на подстроки. То есть, если подготовленная any-подстрока соответствует части значения атрибута, то утверждение, построенное путём разделения этой подстроки на несколько подстрок, также должно соответствовать части значения атрибута.</p>

<p>При разработке приемлемого подхода обработки малозначительных пробельных символов для определения соответствия подстрок, необходимо изучить ключевые аспекты поиска соответствия с учётом и без учёта регистра символов в X.500. В стандарте <a href="#ref-X.520" title="The Directory: Selected Attribute Types">X.520</a> сказано:</p>

<blockquote>
<p>Правило типа [substrings] возвращает TRUE, если имеет место разбиение значения атрибута (на части) таким образом, что:</p>
<ul>
<li>заданные подстроки (initial, any, final) соответствуют разным частям этого значения в порядке последовательности указания этих подстрок;</li>
<li>подстрока initial, если таковая присутствует, соответствует первой части этого значения;</li>
<li>подстрока final, если таковая присутствует, соответствует последней части этого значения;</li>
<li>подстрока any, если таковая присутствует, соответствует некоторой произвольной части этого значения.</li>
</ul>
</blockquote>

<p>То есть, утверждение с подстроками</p>
<pre class="list">
       (CN=foo\20*\20bar)
</pre>
<p>соответствует значению атрибута</p>
<pre class="list">
       "foo&lt;SPACE&gt;&lt;SPACE&gt;bar"
</pre>
<p>, поскольку данное значение может быть разбито на части</p>
<pre class="list">
       "foo&lt;SPACE&gt;"
</pre>
<p>и</p>
<pre class="list">
       "&lt;SPACE&gt;bar"
</pre>
<p>, отвечающие вышеуказанным требованиям.</p>

<p>Также в стандарте X.520 сказано:</p>

<blockquote>
<p>В качестве незначительных рассматриваются следующие пробельные символы:</p>

<ul>
<li>начальные пробелы (то есть те, которые предшествуют первому символу, не являющемуся пробелом);</li>
<li>конечные пробелы (то есть те, которые следуют за последним символом, не являющимся пробелом);</li>
<li>несколько пробелов, следующих друг за другом (они рассматриваются как эквивалент одного символа пробела).</li>
</ul>
</blockquote>

<p>Это правило применяется к значениям утверждения и значениям атрибута как к целым строкам, и не применяется к отдельным подстрокам в значении утверждения. В частности, данное правило следует понимать в том смысле, что если значение утверждения и значение атрибута соответствуют друг другу без какой-либо обработки малозначительных символов, то это значение утверждения должно также соответствовать любому значению атрибута, отличающемуся от первоначального только тем, что в него были включены или из него были удалены малозначительные символы.</p>

<p>Поэтому утверждение</p>
<pre class="list">
       (CN=foo\20*\20bar)
</pre>
<p>соответствует строкам</p>
<pre class="list">
       "foo&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;bar"
</pre>
<p>и</p>
<pre class="list">
       "foo&lt;SPACE&gt;bar"
</pre>
<p>, поскольку они отличаются от</p>
<pre class="list">
       "foo&lt;SPACE&gt;&lt;SPACE&gt;bar"
</pre>
<p>лишь включением или удалением незначительных пробелов.</p>

<p>Внимательные читатели этого текста также обратят внимание на то, что существуют специальные случаи, когда указанная обработка пробельных символов не игнорирует те из них, которые могли бы рассматриваться как незначительные. Например, утверждение</p>
<pre class="list">
       (CN=\20*\20*\20)
</pre>
<p>не соответствует строке</p>
<pre class="list">
       "&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;"
</pre>
<p>(в значении есть незначительные пробелы) или строке</p>
<pre class="list">
       " "
</pre>
<p>(в значении нет незначительных пробелов). Однако, поскольку эти случаи не имеют никакого практического применения и могут быть заменены простыми утверждениями, например,</p>
<pre class="list">
       (cn=\20)
</pre>
<p>а также потому, что такая незначительная аномалия может быть полностью разрешена только путём использования алгоритма подготовки в сочетании с посимвольным разбиением и согласованием, данная аномалия считается приемлемой.</p>

<h2>Адрес автора</h2>
<p>Kurt D. Zeilenga</p>
<p>OpenLDAP Foundation</p>
<p>EMail: Kurt@OpenLDAP.org</p>

<h2>Полное заявление авторских прав</h2>

<p>Copyright (C) Internet Society (2006).</p>

<p>На этот документ распространяются права, лицензии и ограничения, содержащиеся в <a target="_blank" href="http://tools.ietf.org/html/bcp78">BCP 78</a>, и, за исключением случаев, изложенных в нем, авторы сохраняют все свои права.</p>

<p>Этот документ и содержащаяся в нём информация распространяются "КАК ЕСТЬ" и АВТОР ДОКУМЕНТА, ОРГАНИЗАЦИЯ, КОТОРУЮ ОН/ОНА ПРЕДСТАВЛЯЕТ, ИЛИ КОТОРОЙ ОН/ОНА СПОНСИРУЕТСЯ (ЕСЛИ ТАКОВЫЕ ИМЕЮТСЯ), INTERNET SOCIETY И INTERNET ENGINEERING TASK FORCE ОТКАЗЫВАЮТСЯ ОТ ВСЕХ ГАРАНТИЙ, ЯВНЫХ ИЛИ ПОДРАЗУМЕВАЕМЫХ, ВКЛЮЧАЯ, ПОМИМО ПРОЧЕГО, ЛЮБЫЕ ГАРАНТИИ ТОГО, ЧТО ИСПОЛЬЗОВАНИЕ ПРИВЕДЁННОЙ ЗДЕСЬ ИНФОРМАЦИИ НЕ НАРУШАЕТ КАКИХ-ЛИБО ПРАВ ИЛИ ЛЮБЫЕ ПОДРАЗУМЕВАЕМЫЕ ГАРАНТИИ ПРИГОДНОСТИ ДЛЯ КОНКРЕТНЫХ ЦЕЛЕЙ.</p>

<h2>Интеллектуальная собственность</h2>

<p>IETF не занимает никакой позиции относительно действительности или области действия каких-либо прав на интеллектуальную собственность, или других прав, которые могут заявляться как относящиеся к реализации или использованию технологий, описанных в данном документе, либо в подтверждении которых могут или не могут быть доступны какие-либо лицензии; кроме того, IETF не заявляет о том, что она будет предпринимать какие-либо независимые усилия по выявлению подобных прав. Информацию по процедурам в отношении прав в документах RFC можно найти в <a target="_blank" href="http://tools.ietf.org/html/bcp78">BCP 78</a> и <a target="_blank" href="http://tools.ietf.org/html/bcp79">BCP 79</a>.</p>

<p>Копии поданных в секретариат IETF заявлений о правах на интеллектуальную собственность (Intellectual Property Rights, IPR), а также какие-либо документы, подтверждающие лицензию и предназначенные для предоставления доступа к ним, либо результаты попыток получения генеральных лицензий или разрешений на пользование подобными правами собственности могут быть получены теми, кто занимается реализацией, или пользователями данной спецификации из он-лайн репозитория IPR IETF по адресу <a target="_blank" href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.</p>

<p>IETF просит всех заинтересованных лиц довести до её сведения любые авторские права, патенты или патентные заявки, либо другие права собственности, которые могут касаться технологий данного стандарта и могут потребоваться для его реализации. Пожалуйста, направляйте информацию в IETF по адресу ietf-ipr@ietf.org.</p>

<h2>Признание заслуг</h2>

<p>Финансирование функций RFC Editor обеспечивается IETF Administrative Support Activity (IASA).</p>

<div style="font-size:90%;font-style:italic;margin:30px">Перевод выполнен участниками проекта <a href="http://pro-ldap.ru">Pro-LDAP.ru</a>. Предложения по улучшению перевода и сообщения об ошибках принимаются на <a href="http://pro-ldap.ru/forum/index.php?topic=40.0">форуме проекта</a>.</div>
</body></html>
